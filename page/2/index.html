<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="好记性不如烂笔头,更何况记性还不好">
<meta property="og:type" content="website">
<meta property="og:title" content="Fujia's Blog">
<meta property="og:url" content="https://fujiador.github.io/page/2/index.html">
<meta property="og:site_name" content="Fujia's Blog">
<meta property="og:description" content="好记性不如烂笔头,更何况记性还不好">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fujia's Blog">
<meta name="twitter:description" content="好记性不如烂笔头,更何况记性还不好">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://fujiador.github.io/page/2/"/>





  <title> Fujia's Blog </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Fujia's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">点滴技术的印记</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://fujiador.github.io/2017/04/27/《Python算法教程》读书笔记-（四）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Fujia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fujia's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/27/《Python算法教程》读书笔记-（四）/" itemprop="url">
                  《Python算法教程》读书笔记 - （四）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-27T22:26:51+08:00">
                2017-04-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="树的概念"><a href="#树的概念" class="headerlink" title="树的概念"></a>树的概念</h3><p>树，本身就是图的一种特殊情况。树在算法中扮演着及其重要的角色，并且有许多特定问题是推荐用树结构来解决。大部分树算法都可以被理解成一般图概念中的思路，但特定的树结构会使得它们更容易实现。</p>
<p>最容易表示的就是带根的树结构，这种树的每条边都从根出发，并向下延伸。此类结构所代表的往往是某个数据集所拥有的层次结构，其根节点代表着全部对象，而其内部各节点所代表的对象都是以该节点为根的树结构的叶节点。</p>
<p>示例如下图：</p>
<p>可以将该树表示成一个二维列表(lists of lists)，代码如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>T = [[<span class="string">'a'</span>, <span class="string">'b'</span>], [<span class="string">'c'</span>], [<span class="string">'d'</span>, [<span class="string">'e'</span>, <span class="string">'f'</span>]]]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>T[<span class="number">0</span>][<span class="number">1</span>]</div><div class="line">&gt; b</div><div class="line"></div><div class="line"><span class="comment"># 访问的一次是根节点的第三个子节点,然后是该子节点的第二个子节点,最后是这个子节点的第一个子节点，即页节点</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>T[<span class="number">2</span>][<span class="number">1</span>][<span class="number">0</span>]</div><div class="line">&gt; <span class="string">'e'</span></div></pre></td></tr></table></figure></p>
<p>这种方法中，每个列表表示的都是相应内部（匿名）节点所拥有的一个包含其所有相邻节点的列表。</p>
<hr>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>有时实现知道其内部所能拥有的最大子节点数(如二叉树，各节点最多只能拥有两个子节点)，所以可以选择其他表示法，如为各对象的各子节点设置相应的属性。还可以用None值来表示不存在的子节点。如下代码所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 二叉树类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tree</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,left,right)</span>:</span></div><div class="line">		self.left = left</div><div class="line">		self.right = right</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t = Tree(Tree(<span class="string">"a"</span>,<span class="string">"b"</span>),Tree(<span class="string">"c"</span>,<span class="string">"d"</span>))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t.right.left</div><div class="line">&gt; <span class="string">"c"</span></div></pre></td></tr></table></figure></p>
<p>对于没有内置list类型的语言，还有一种常见的树实现方式，即采取“先子节点，后兄弟节点”的表示方法。在这种表示法里，每一个树节点都有两个用于引用其他节点的“指针”或属性，这似乎与二叉树的情况很类似。然而在这里，<strong>!第一个引用指向的是当前节点的第一个子节点!</strong>，而<strong>!第二个引用所指向的则是下一个兄弟节点!</strong>。换句话说，这里的各个节点所对应用的是一个其子节点的兄弟节点链表，并且这些兄弟节点又各自引用了属于他们自己的那个兄弟节点链表。如下代码所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 多路搜索树类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tree</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,kids,next=None)</span>:</span></div><div class="line">		self.kids = self.val = kids</div><div class="line">		self.next = next</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t = Tree(Tree(<span class="string">"d"</span>,Tree(<span class="string">"b"</span>,Tree(<span class="string">"c"</span>,Tree(<span class="string">"d"</span>)))))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t.kids.next.next.val</div><div class="line">&gt; <span class="string">"c"</span></div></pre></td></tr></table></figure></p>
<p><strong>小插曲：Bunch模式</strong></p>
<blockquote>
<p>“Bunch设计模式”，基本上其实现方式中都会具备以下要素：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bunch</span><span class="params">(dict)</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,*args,**kwds)</span>:</span></div><div class="line">		super(Bunch, self).__init__(*args,**kwds)</div><div class="line">		self.__dict__ = self</div></pre></td></tr></table></figure></p>
</blockquote>
<p>该模式主要有几个有用的方面.首先，它能让我们以命令行参数的形式创建相关对象，并设置任何属性：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = Bunch(name=<span class="string">"Jayne Cobb"</span>,position=<span class="string">"Public Relations"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.name</div><div class="line">&gt; <span class="string">"Jayne Cobb"</span></div><div class="line"><span class="comment"># x的结果</span></div><div class="line">&#123;<span class="string">'name'</span>: <span class="string">'Jayne Cobb'</span>, <span class="string">'position'</span>: <span class="string">'Public Relations'</span>&#125;</div></pre></td></tr></table></figure></p>
<p>其次，由于它继承自dict类，可以自然而然地获得大量相关的操作。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>T = Bunch</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t = T(left=T(left=<span class="string">"a"</span>,right=<span class="string">"b"</span>),right=T(left=<span class="string">"c"</span>))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t.left.right</div><div class="line">&gt; <span class="string">"b"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t[<span class="string">'left'</span>][<span class="string">'right'</span>]</div><div class="line">&gt; <span class="string">"b"</span></div></pre></td></tr></table></figure></p>
<p>注：Bunch设计模式直观的感受是递归调用，但是没有理解，后续在回过头来学习这块内容~</p>
<hr>
<h3 id="树的多种表示法"><a href="#树的多种表示法" class="headerlink" title="树的多种表示法"></a>树的多种表示法</h3><p>常用的表示方法：邻接列表、邻接数组、邻接矩阵。</p>
<p>在邻接矩阵中，查询边(u,v)需要的时间为$\theta(1)$，遍历v邻居的操作时间为$\theta(n)$，而到了邻接列表这种表示法中，两种操作所需要的时间都为$\theta(d(v))$。</p>
<p>解析XML文档或者遍历某文件系统目录结构时，直接使用现成的树结构和API。</p>
<p>最后介绍的一类图结构叫做<strong>子问题图(subproblem graph)</strong>，将来在学习各种不同算法技术时还会多次涉及它。</p>
<p>这个概念简单地说就是，绝大部分问题应该都可以被分成若干个子问题，这些子问题在结构上往往都非常相似。因此，这些结构可以被看做相关子问题图中的节点，而它们间的依赖关系就称为该图的边。例如，分治法以及动态规划等技术就出自这些分析。</p>
<hr>
<h3 id="算法编程中提防的陷阱"><a href="#算法编程中提防的陷阱" class="headerlink" title="算法编程中提防的陷阱"></a>算法编程中提防的陷阱</h3><ol>
<li>当性能成为重点问题时，要着重于实际分析而不是直觉。</li>
<li>当正确性至关重要时，最好的做法是用不同的实现体来对答案进行多次计算，即冗余原则。</li>
</ol>
<h4 id="隐性平方级操作"><a href="#隐性平方级操作" class="headerlink" title="隐性平方级操作"></a>隐性平方级操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> random <span class="keyword">import</span> randrange</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>L = [randrange(<span class="number">10000</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>)]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">42</span> <span class="keyword">in</span> L</div><div class="line">&gt; <span class="keyword">False</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>S =set(L)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">42</span> <span class="keyword">in</span> S</div><div class="line">&gt; <span class="keyword">False</span></div></pre></td></tr></table></figure>
<p>这个示例很能说明问题。正如书中所说，两种方式都很快，似乎在list上构建一个set是毫无意义的。实际代码的构造是依据具体情况的。如果进行多次成员查询操作，这样做值得！因为成员检测在list中是线性级的，而在set中则是常数级的。如果想依次往集合里添加新值，并在每一步中都检查该值是否已经被添加的话，这种情况用list来处理的话，运行时间是平方级的，而用set就可以获得线性级时间。 </p>
<p>但也有一些不那么明显的例子，它们也会带来许多问题。如下代码所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">S = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> chunk <span class="keyword">in</span> string_producer():</div><div class="line">	s += chunk</div></pre></td></tr></table></figure></p>
<p>Python自身采用了一些非常聪明的优化，它在扩展到某一规模之前都能工作的很好 — 但随后这些优化的作用就会消退，运行时间也因此猛然呈现出平方级的增长。问题在于，需要在每次执行+=操作时新建一个字符串，并复制上一个字符串内容。这是一个有风险的业务逻辑。它有一个更好的解决方案：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">chunks = []</div><div class="line"><span class="keyword">for</span> chunk <span class="keyword">in</span> string_producer():</div><div class="line">	chunks.append(chunk)</div><div class="line">s = <span class="string">''</span>.join(chunks)</div><div class="line"><span class="comment"># 更优化</span></div><div class="line">s = <span class="string">''</span>.join(string_producer())</div></pre></td></tr></table></figure></p>
<h4 id="浮点数运算的麻烦"><a href="#浮点数运算的麻烦" class="headerlink" title="浮点数运算的麻烦"></a>浮点数运算的麻烦</h4><p>第一课就是“不要对浮点数进行等值比较”。实际应用中，我们可以检查它们是否接近于相等。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 2.7.10</span></div><div class="line">&gt;&gt;&gt;sum(<span class="number">0.1</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)) == <span class="number">1.0</span></div><div class="line">&gt;<span class="keyword">False</span></div><div class="line"></div><div class="line"><span class="comment"># 改进实现</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">almost_equal</span><span class="params">(x, y, places=<span class="number">7</span>)</span>:</span></div><div class="line">	<span class="keyword">return</span> round(abs(x-y),places) == <span class="number">0</span></div><div class="line">&gt;&gt;&gt;almost_equal(sum(<span class="number">0.1</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)),<span class="number">1.0</span>)</div><div class="line">&gt;<span class="keyword">True</span></div></pre></td></tr></table></figure></p>
<p>此外，如果需要某种精确的十进制浮点数表示法，可以选择使用其他工具，如<code>decimal</code>模块：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> *</div><div class="line">sum(Decimal(<span class="string">"0.1"</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)) == Decimal(<span class="string">"1.0"</span>)</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://fujiador.github.io/2017/04/26/《Python算法教程》读书笔记-（三）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Fujia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fujia's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/26/《Python算法教程》读书笔记-（三）/" itemprop="url">
                  《Python算法教程》读书笔记 - （三）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-26T22:18:00+08:00">
                2017-04-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这篇博客重点是<strong>图与树</strong>的实现。</p>
<hr>
<h3 id="图与树"><a href="#图与树" class="headerlink" title="图与树"></a>图与树</h3><p>算法中最强大的框架之一 — 图结构(graph)，通常，如果可以讲问题诠释成一个图问题的话，至少该问题已经接近解决方案了；如果可以用树结构(tree)来诠释的话，基本已经拥有了一个真正的解决方案！足以说明树结构和图结构的重要性！</p>
<p>图结构可以表现几乎所有类型的结构与系统，例如交通网络、通信网络、细胞核交互、社交关系等等，并可通过添加权重值、距离值等额外数据来增强其表现能力。而树结构只是图结构的一种特殊情况。有很多的机构形式，如XML文档或者目录层次结构等等，实际上也都是用树结构来表现的。</p>
<p>以下是一些图术语：</p>
<blockquote>
<ol>
<li>图$G=(V,E)$通常由一组节点$V$及节点间的边$E$共同组成。如果这些边是带有方向的，则称其为有向图；</li>
<li>节点之间是通过边来实现彼此相连的。这些边其实就是节点$v$与其邻居之间的关系。与节点$v$相邻的节点，称为节点$v$的邻居。<strong>一个节点的度数就是连接其边的个数。</strong></li>
<li>图$G=(V,E)$的子图结构将由$V$的子集与$E$的子集共同组成。在$G$中没一条路径(path)是一个子图结构，本质上都是一些由多个节点串联而成的边线序列。环路(cycle)的定义与路径基本相同，只不过它最后一条边所连接末节点同时是它的首节点。</li>
<li>如果将图$G$中的每条边与某种权值联系在一起，就成为一种加权图。在加权图中，一条路径或环路的长度等于各条边上的权值之和；而对于非加权图而言，就直接等于该图的边数了。</li>
<li>森林(forest)可以被认为是一个无环路图，而这样的连通图就是一棵树。实质上，森林就是由一棵或多棵树构成的。</li>
</ol>
</blockquote>
<hr>
<h3 id="图数据结构"><a href="#图数据结构" class="headerlink" title="图数据结构"></a>图数据结构</h3><p>上面目前介绍关于图的一些基本概念，接下来核心知识即学会用某种数据结构来表示图。</p>
<p>用抽象属于来说，倾向于采用一种被称为邻近函数$N(v)$(neighborhood function)的实现方式。在这，会涉及一个容器N[v]，主要用于存储v节点的邻近节点。常见图数据结构主要放在<strong>邻接列表和邻接矩阵</strong>这两种著名的表现形式上，它们的可用性和普及率都很高。</p>
<p><strong>小插曲：黑盒子专栏之 dict 和 set</strong></p>
<blockquote>
<p>散列(hashing)在算法中及其常见，在Python语言中，标准散列机制是由hash函数提供的，如下调用一个对象的<code>__hash__</code>方法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; hash(<span class="number">42</span>)</div><div class="line"><span class="number">42</span></div><div class="line">&gt; hash(<span class="string">"Hello,World!"</span>)</div><div class="line"><span class="number">1564194085</span></div></pre></td></tr></table></figure></p>
<p>该机制常用于字典类型(dict)的实现，dict就是通常所说的散列表。同样，集合类型(set)也是通过这种机制实现的。记住最重要的一点，<strong>散列值的构成基本上是在常数级时间内完成的</strong>。这意味着在对dict和set中的元素进行访问时所消耗的时间都是常数级别的，对于构建更为复杂的结构与算法是非常有用的！</p>
</blockquote>
<p>后续详细的学习下hash方法和<code>hashlib</code>模块。</p>
<hr>
<h3 id="邻接列表与其类似结构"><a href="#邻接列表与其类似结构" class="headerlink" title="邻接列表与其类似结构"></a>邻接列表与其类似结构</h3><p>对于图结构而言，最直观的实现方式之一就是使用邻接列表。即要针对每个结点设置一个邻居列表（也可以使set等其他容器或迭代器类型）。</p>
<p>接下来实现一个最简单的：假设有n个结点，编号分别为$0,1,…,n-1$，然后每个邻接(邻居)列表就都指示一个数字列表，可以讲它们编入一个大小为n的主列表，并用节点编号对其进行索引。由于这些列表内的顺序是任意的，所以实际上我们是使用集合来实现邻接集(adjacency sets)。</p>
<p>以下图为例具体说明图结构的各种表示法：</p>
<p>首先，完成对节点的编号工作$(a=0,b=1,c=2,d=3,e=4,f=5,g=6,h=7)$。该图可以先用一种简单明了的方式来表示，如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 简单明了的邻接集表示法</span></div><div class="line">a, b, c, d, e, f, g, h = range(<span class="number">8</span>)</div><div class="line">N = [</div><div class="line">	&#123;b, c, d, e, f&#125;,  <span class="comment"># a</span></div><div class="line">	&#123;c, e&#125;,           <span class="comment"># b</span></div><div class="line">	&#123;d&#125;,              <span class="comment"># c</span></div><div class="line">	&#123;e&#125;,              <span class="comment"># d</span></div><div class="line">	&#123;f&#125;,              <span class="comment"># e</span></div><div class="line">	&#123;c, g, h&#125;,        <span class="comment"># f</span></div><div class="line">	&#123;f, h&#125;,           <span class="comment"># g</span></div><div class="line">	&#123;f, g&#125;            <span class="comment"># h</span></div><div class="line">]</div><div class="line"><span class="comment">## 结果,在Ipython中结果如下，在Python解释器中是类似set([1,2,3,4,5])。</span></div><div class="line">&gt; [&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;, &#123;<span class="number">2</span>, <span class="number">4</span>&#125;, &#123;<span class="number">3</span>&#125;, &#123;<span class="number">4</span>&#125;, &#123;<span class="number">5</span>&#125;, &#123;<span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>&#125;, &#123;<span class="number">5</span>, <span class="number">7</span>&#125;, &#123;<span class="number">5</span>, <span class="number">6</span>&#125;]</div></pre></td></tr></table></figure></p>
<p>变量N作用相当于之前提到的N函数。在图论中，$N(v)$代表的是v节点的邻居节点集。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; N[a]    <span class="comment"># a节点的邻居节点集</span></div><div class="line">&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</div><div class="line">&gt; b <span class="keyword">in</span> N[a]   <span class="comment"># 判断b节点是否是a节点的邻居节点</span></div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure></p>
<p>在某些情况下，另一种表示方法的开销会更小一些，即用真正的邻接列表来代替上面的邻接集。如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 简单明了的邻接列表示法</span></div><div class="line">a, b, c, d, e, f, g, h = range(<span class="number">8</span>)</div><div class="line">N = [</div><div class="line">	[b, c, d, e, f],  <span class="comment"># a</span></div><div class="line">	[c, e],           <span class="comment"># b</span></div><div class="line">	[d],              <span class="comment"># c</span></div><div class="line">	[e],              <span class="comment"># d</span></div><div class="line">	[f],              <span class="comment"># e</span></div><div class="line">	[c, g, h],        <span class="comment"># f</span></div><div class="line">	[f, h],           <span class="comment"># g</span></div><div class="line">	[f, g]            <span class="comment"># h</span></div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>这种表示法可能存在着一个争议，因为它实际上是一组邻接数组的结合，而并非传统意义上的邻接列表。</p>
<p>在Python中，list类型的背后实际上是一个<strong>动态数组</strong>。</p>
<p>在执行与图有关的工作时，要遵从一个主题思想，即一个图的最佳表示方法应该取决于我们用它来做什么！例如，邻接列表(或数组)可以让我们在维持低成本的情况下，对$N(v)$中所有节点v进行有效遍历。然而，在检查u和v是否互为邻居时的成本就是$\theta(N(v))$。这时如果改图的结构很密集(如果它的边很多的话)，很可能会带来一些问题，此时邻接集或许是个更好的选择。</p>
<p>还有另外一种表示方法，就是用dict类型来替代这里的set或list。在dict类型中，每个邻居几点都会有一个键值对，用于表示与其邻居节点（或<strong>出边</strong>）之间的关联性，如边的权重。如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 加权邻接字典</span></div><div class="line">a, b, c, d, e, f, g, h = range(<span class="number">8</span>)</div><div class="line">N = [</div><div class="line">	&#123;b:<span class="number">2</span>, c:<span class="number">1</span>, d:<span class="number">3</span>, e:<span class="number">9</span>, f:<span class="number">4</span>&#125;,  <span class="comment"># a</span></div><div class="line">	&#123;c:<span class="number">4</span>, e:<span class="number">4</span>&#125;,           <span class="comment"># b</span></div><div class="line">	&#123;d:<span class="number">8</span>&#125;,              <span class="comment"># c</span></div><div class="line">	&#123;e:<span class="number">7</span>&#125;,              <span class="comment"># d</span></div><div class="line">	&#123;f:<span class="number">5</span>&#125;,              <span class="comment"># e</span></div><div class="line">	&#123;c:<span class="number">2</span>, g:<span class="number">2</span>, h:<span class="number">2</span>&#125;,        <span class="comment"># f</span></div><div class="line">	&#123;f:<span class="number">1</span>, h:<span class="number">6</span>&#125;,           <span class="comment"># g</span></div><div class="line">	&#123;f:<span class="number">9</span>, g:<span class="number">8</span>&#125;            <span class="comment"># h</span></div><div class="line">]</div><div class="line">&gt;&gt;&gt;b <span class="keyword">in</span> N[a]    <span class="comment"># Neighborhood membership  邻节点成员关系</span></div><div class="line">&gt;<span class="keyword">True</span></div><div class="line">&gt;&gt;&gt;len(N[f])    <span class="comment"># Degree   节点的度</span></div><div class="line">&gt;<span class="number">3</span></div><div class="line">&gt;&gt;&gt;N[a][b]      <span class="comment"># Edge weight for (a,b) 节点a到节点b的权重</span></div><div class="line">&gt;<span class="number">2</span></div></pre></td></tr></table></figure></p>
<p>目前为止，用来存储邻接结构（可能是list、set、dict）的主要容器其实都是列表类型，它们都以节点编号为索引值。对灵活性而言，使用dict类型来作为主要存储结构会是一种更好的选择（因为它允许我们使用任意可散列的对象来充当节点标签）。用dict存储邻接集的具体示例如下所示，在这里是用字符来表示相关节点的。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 邻接集的字典表示法</span></div><div class="line">N = &#123;</div><div class="line">	<span class="string">'a'</span>:set(<span class="string">'bcdef'</span>),        <span class="comment"># a</span></div><div class="line">	<span class="string">'b'</span>:set(<span class="string">'ce'</span>),           <span class="comment"># b</span></div><div class="line">	<span class="string">'c'</span>:set(<span class="string">'d'</span>),            <span class="comment"># c</span></div><div class="line">	<span class="string">'d'</span>:set(<span class="string">'e'</span>),            <span class="comment"># d</span></div><div class="line">	<span class="string">'e'</span>:set(<span class="string">'f'</span>),            <span class="comment"># e</span></div><div class="line">	<span class="string">'f'</span>:set(<span class="string">'cgh'</span>),          <span class="comment"># f</span></div><div class="line">	<span class="string">'g'</span>:set(<span class="string">'fh'</span>),           <span class="comment"># g</span></div><div class="line">	<span class="string">'h'</span>:set(<span class="string">'fg'</span>)            <span class="comment"># h</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<hr>
<h3 id="邻接矩阵"><a href="#邻接矩阵" class="headerlink" title="邻接矩阵"></a>邻接矩阵</h3><p>图的另一种常见表示法就是邻接矩阵了！这种表示的主要不同之处在于，它不再列出每个节点的所有邻居节点，而是会将每个节点可能的邻居位置排成一排（也就是一个数组，用于对应图中每个节点），然后用某种值（True或False）来表示相关节点是否为当前节点的邻居。</p>
<p>其最简单的形式也可以用嵌套list来实现，如下所示，其中，节点编号依然是从0到$V-1$，并且为了让矩阵具有更好的可读性，会用1和0来填充真值。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 用嵌套list实现的邻接矩阵</span></div><div class="line">a, b, c, d, e, f, g, h = range(<span class="number">8</span>)</div><div class="line"></div><div class="line">N = [</div><div class="line">	[<span class="number">0</span>，<span class="number">1</span>，<span class="number">1</span>，<span class="number">1</span>，<span class="number">1</span>，<span class="number">1</span>，<span class="number">0</span>，<span class="number">0</span>],    <span class="comment"># a</span></div><div class="line">	[<span class="number">0</span>，<span class="number">0</span>，<span class="number">1</span>，<span class="number">0</span>，<span class="number">1</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>],    <span class="comment"># b</span></div><div class="line">	[<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">1</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>],    <span class="comment"># c</span></div><div class="line">	[<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">1</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>],    <span class="comment"># d</span></div><div class="line">	[<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">1</span>，<span class="number">0</span>，<span class="number">0</span>],    <span class="comment"># e</span></div><div class="line">	[<span class="number">0</span>，<span class="number">0</span>，<span class="number">1</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">1</span>，<span class="number">1</span>],    <span class="comment"># f</span></div><div class="line">	[<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">1</span>，<span class="number">0</span>，<span class="number">1</span>],    <span class="comment"># g</span></div><div class="line">	[<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">0</span>，<span class="number">1</span>，<span class="number">1</span>，<span class="number">0</span>],    <span class="comment"># h</span></div><div class="line">]</div><div class="line">&gt;&gt;&gt;N[a][b]    <span class="comment"># Neighborhood membership</span></div><div class="line">&gt;<span class="number">1</span></div><div class="line">&gt;&gt;&gt;sum(N[f])    <span class="comment"># Degree</span></div><div class="line">&gt;<span class="number">3</span></div></pre></td></tr></table></figure></p>
<p>在使用方式上与邻接列表或邻接集略有不同。邻居关系检查是要检查矩阵单元N[a][b]是否为真。相关节点的邻居数度，用sum函数求得。</p>
<p>在邻接矩阵中，有一些实用的特性。</p>
<blockquote>
<p>首先，只要不允许出现自循环状态，其对角线上的值应该全为假。<br>而且，通过向现有表示法中加入双向边元素的方式来实现一个无向图，这就意味着无向图的邻接矩阵应该是一个对称矩阵。</p>
</blockquote>
<p>将邻接矩阵扩展成对边进行加权处理，也非常简单：在原来存储真值的地方直接存储对应的权值即可。</p>
<p>例如：对于边$(u,v)$来说，只需要将N[u][v]处的True替换成$\omega(u,v)$的权值即可。出于某些实践因素的考虑，通常会将一些实际不存在的边的权值设置为无穷大。（这可以确保它们不会被纳入考虑的范围，也就是说，在考虑<strong>最短路径</strong>时，我们只要根据实际存在的那些边来寻找合适路径）。</p>
<p>也可以设置为一个非法的权值，如None、-1。但许多情况下，更实用的做法是设置一个非常大的值。通常对于整型加权值来说，用<code>sys.maxint</code>即可。在对浮点型的设计中，有一个可以代表无穷大的值：inf。该值在python中没有直接可用的名称，但我们可以通过<code>float(&#39;inf&#39;)</code>表达式来获取它。</p>
<p>如下所示，演示了如何用嵌套list来实现一个加权矩阵。要注意的是，该矩阵对角线上的值依然应该全为0，因为即使在没有自循环存在的情况下，相关权值也往往会被解释称为某种距离形式，从理解上来说，任一节点到自身的距离都应该始终是0。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#对不存在的边赋予无限大权值的加权矩阵</span></div><div class="line">a, b, c, d, e, f, g, h = range(<span class="number">8</span>)</div><div class="line">inf = float(<span class="string">'inf'</span>)</div><div class="line">W = [</div><div class="line">    [<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">4</span>,inf,inf], <span class="comment">#a</span></div><div class="line">    [inf,<span class="number">0</span>,<span class="number">4</span>,inf,<span class="number">3</span>,inf,inf,inf],  <span class="comment">#b</span></div><div class="line">    [inf,inf,<span class="number">0</span>,<span class="number">8</span>,inf,inf,inf,inf], <span class="comment">#c</span></div><div class="line">    [inf,inf,inf,<span class="number">0</span>,<span class="number">7</span>,inf,inf,inf], <span class="comment">#d</span></div><div class="line">    [inf,inf,inf,inf,<span class="number">0</span>,<span class="number">5</span>,inf,inf], <span class="comment">#e</span></div><div class="line">    [inf,inf,<span class="number">2</span>,inf,inf,<span class="number">0</span>,<span class="number">2</span>,<span class="number">2</span>], <span class="comment">#f</span></div><div class="line">    [inf,inf,inf,inf,inf,<span class="number">1</span>,<span class="number">0</span>,<span class="number">6</span>], <span class="comment">#g</span></div><div class="line">    [inf,inf,inf,inf,inf,<span class="number">9</span>,<span class="number">8</span>,<span class="number">0</span>] <span class="comment">#h</span></div><div class="line">]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>W[a][b] &lt; inf <span class="comment">#Neighborhood membership</span></div><div class="line">&gt; <span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>W[c][e] &lt; inf <span class="comment"># Neighborhood membership</span></div><div class="line">&gt; <span class="keyword">False</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>sum(<span class="number">1</span> <span class="keyword">for</span> w <span class="keyword">in</span> W[a] <span class="keyword">if</span> w &lt; inf) - <span class="number">1</span>  <span class="comment"># Degree</span></div><div class="line">&gt; <span class="number">5</span>    <span class="comment"># -1 是因为节点与其自身不算做边</span></div></pre></td></tr></table></figure></p>
<p>如上成员检测、查找某个特定节点的度(degree)。尽管这个表达结构在度的计算上的操作复杂度是$\theta(n)$，但它很适合于相关成员与度的查找计算操作，并且这些操作在常数时间内完成。</p>
<p><strong>小插曲</strong></p>
<blockquote>
<p>Numpy库提供大量与多维数组有关的功能。就Numpy中的数组类型而言，对于实现邻接矩阵或加权矩阵是非常不错的。<br>例如，当需要一个基于list的、面向n个结点的空加权（或邻接）矩阵时，通常这样实现：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>N= [[<span class="number">0</span>] * <span class="number">10</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)]</div><div class="line"><span class="comment"># 而在Numpy中，通过zeros函数实现：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>N = np.zeros([<span class="number">10</span>,<span class="number">10</span>])</div><div class="line"><span class="comment"># 结果</span></div><div class="line">array([[ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">       [ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">       [ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">       [ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">       [ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">       [ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">       [ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">       [ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">       [ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">       [ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>]])</div></pre></td></tr></table></figure></p>
<p>如果处理的是相对稀疏的图，即矩阵中只有一小部分有值，可通过更为特殊的一种稀疏矩阵的形式来节省内存开销。可以再Scipy中的scipy.sparse模块找到。</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://fujiador.github.io/2017/04/26/数据需求-填充Excel-Cell/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Fujia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fujia's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/26/数据需求-填充Excel-Cell/" itemprop="url">
                  [数据需求] 填充Excel Cell
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-26T12:11:17+08:00">
                2017-04-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="需求说明"><a href="#需求说明" class="headerlink" title="需求说明"></a>需求说明</h3><p>这个数据需求来自Q群水友：期望将Excel内各行的数据，在首次出现数字1之后的空单元格填充为0，单元格值为1的单元格保留不变。</p>
<p>常规的VBA可以进行处理，因为VBA已经多年不用，现在用Python来解决实现这一需求。</p>
<p>需求数据示例如下：<br><img src="http://on58f12qv.bkt.clouddn.com/%E9%9C%80%E6%B1%82%E6%A0%B7%E5%BC%8F.png" alt="需求数据样例"></p>
<p>处理转化为结果示例如下：<br><img src="http://on58f12qv.bkt.clouddn.com/%E7%BB%93%E6%9E%9C%E6%A0%B7%E5%BC%8F.png" alt="需求结果样例"></p>
<hr>
<h3 id="python实现"><a href="#Python实现" class="headerlink" title="Python实现"></a>Python实现</h3><h4 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h4><p>python version：2.7.10<br>系统：windows</p>
<h4 id="第三方package"><a href="#第三方Package" class="headerlink" title="第三方Package"></a>第三方Package</h4><p>OpenPyXL<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install openpyxl</div></pre></td></tr></table></figure></p>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#! -*- coding:utf-8 -*-</span></div><div class="line"><span class="comment">#! -*- coding:utf-8 -*-</span></div><div class="line">__author__ = <span class="string">'FJ'</span></div><div class="line"><span class="string">"""</span></div><div class="line">需求: 在excel sheet页内,在每行row中,将首次出现数字1之后的空cell填充数字0</div><div class="line">python env : 2.7.10</div><div class="line">Excel version : 2016 (适用版本没有正式测试,Excel的版本应该都可以)</div><div class="line">"""</div><div class="line"></div><div class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</div><div class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">operation_data</span><span class="params">(object)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,workbook_path,sheet_name)</span>:</span></div><div class="line">        self.workbook_path = workbook_path</div><div class="line">        self.sheet_name = sheet_name</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_workbook</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            self.workbook = load_workbook(self.workbook_path)</div><div class="line">        <span class="keyword">except</span> Exception,e:</div><div class="line">            <span class="keyword">print</span> <span class="string">"Please check and input the correct workbook name!"</span></div><div class="line">        sheetnames = self.workbook.get_sheet_names()</div><div class="line">        <span class="keyword">if</span> sheet_name <span class="keyword">in</span> sheetnames:</div><div class="line">            self.worksheet = self.workbook.get_sheet_by_name(sheet_name)</div><div class="line">            <span class="keyword">return</span> self.workbook,self.worksheet</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">"Please check and input the correct worksheet name!"</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span>,<span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_cell_content</span><span class="params">(self)</span>:</span></div><div class="line">        MAX_ROW = self.worksheet.max_row</div><div class="line">        MAX_COL = self.worksheet.max_column</div><div class="line">        self.cell_dict = defaultdict(list)</div><div class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(<span class="number">1</span>,MAX_ROW+<span class="number">1</span>):</div><div class="line">            <span class="keyword">for</span> col <span class="keyword">in</span> range(<span class="number">1</span>,MAX_COL+<span class="number">1</span>):</div><div class="line">                <span class="keyword">try</span>:</div><div class="line">                    value = self.worksheet.cell(row=row, column=col).value</div><div class="line">                    self.cell_dict[row].append(value)</div><div class="line">                <span class="keyword">except</span> Exception,e:</div><div class="line">                    <span class="keyword">print</span> e</div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    <span class="keyword">continue</span></div><div class="line">        <span class="keyword">return</span> self.cell_dict</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update_cell_content</span><span class="params">(self)</span>:</span></div><div class="line">        n,m = len(self.cell_dict),len(self.cell_dict[<span class="number">1</span>])</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,n+<span class="number">1</span>):</div><div class="line">            <span class="keyword">if</span> <span class="number">1</span> <span class="keyword">in</span> self.cell_dict[i]:</div><div class="line">                j = self.cell_dict[i].index(<span class="number">1</span>)</div><div class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> range(j,m):</div><div class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> self.cell_dict[i][k]:</div><div class="line">                        self.cell_dict[i][k] = <span class="number">0</span></div><div class="line">                    <span class="keyword">else</span>:</div><div class="line">                        <span class="keyword">continue</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                <span class="keyword">continue</span></div><div class="line">        <span class="keyword">return</span> self.cell_dict</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write_excel</span><span class="params">(self,workbook_name)</span>:</span></div><div class="line">        n,m = len(self.cell_dict),len(self.cell_dict[<span class="number">1</span>])</div><div class="line">        worksheet = self.workbook.create_sheet(<span class="string">'Sheet2'</span>,<span class="number">0</span>)</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,n+<span class="number">1</span>):</div><div class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,m+<span class="number">1</span>):</div><div class="line">                worksheet.cell(row=i,column=j,value=self.cell_dict[i][j<span class="number">-1</span>])</div><div class="line">        self.workbook.save(workbook_name)</div><div class="line">        <span class="keyword">print</span> <span class="string">"The data transform has been done successfully!"</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(self)</span>:</span></div><div class="line">        workbook,worksheet = self.get_workbook()</div><div class="line">        cell_dict = self.get_cell_content()</div><div class="line">        cell_dict = self.update_cell_content()</div><div class="line">        self.write_excel(<span class="string">u"测试结果1.xlsx"</span>)</div><div class="line">        <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    workbook_path,sheet_name = <span class="string">u'./测试.xlsx'</span>,<span class="string">'Sheet1'</span></div><div class="line">    excel_obj = operation_data(workbook_path,sheet_name)</div><div class="line">    excel_obj.main()</div><div class="line"></div><div class="line"><span class="comment"># ------------------------------------------</span></div><div class="line"><span class="comment">#! -*- coding:utf-8 -*-</span></div><div class="line">__author__ = <span class="string">'FJ'</span></div><div class="line"><span class="string">"""</span></div><div class="line">需求: 在excel sheet页内,在每行row中,将首次出现数字1之后的空cell填充数字0</div><div class="line">python env : 2.7.10</div><div class="line">Excel version : 2016 (适用版本没有正式测试,Excel的版本应该都可以)</div><div class="line">"""</div><div class="line"></div><div class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</div><div class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_workbook</span><span class="params">(workbook_path,sheet_name)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        workbook = load_workbook(workbook_path)</div><div class="line">    <span class="keyword">except</span> Exception,e:</div><div class="line">        <span class="keyword">print</span> <span class="string">"Please check and input the correct workbook name!"</span></div><div class="line">    sheetnames = workbook.get_sheet_names()</div><div class="line">    <span class="keyword">if</span> sheet_name <span class="keyword">in</span> sheetnames:</div><div class="line">        worksheet = workbook.get_sheet_by_name(sheet_name)</div><div class="line">        <span class="keyword">return</span> workbook,worksheet</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">print</span> <span class="string">"Please check and input the correct worksheet name!"</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">None</span>,<span class="keyword">None</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_cell_content</span><span class="params">(worksheet)</span>:</span></div><div class="line">    MAX_ROW = worksheet.max_row</div><div class="line">    MAX_COL = worksheet.max_column</div><div class="line">    result = defaultdict(list)</div><div class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> range(<span class="number">1</span>,MAX_ROW+<span class="number">1</span>):</div><div class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> range(<span class="number">1</span>,MAX_COL+<span class="number">1</span>):</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                value = worksheet.cell(row=row, column=col).value</div><div class="line">                result[row].append(value)</div><div class="line">            <span class="keyword">except</span> Exception,e:</div><div class="line">                <span class="keyword">print</span> e</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                <span class="keyword">continue</span></div><div class="line">    <span class="keyword">return</span> result</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_cell_content</span><span class="params">(cell_dict)</span>:</span></div><div class="line">    n,m = len(cell_dict),len(cell_dict[<span class="number">1</span>])</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,n+<span class="number">1</span>):</div><div class="line">        <span class="keyword">if</span> <span class="number">1</span> <span class="keyword">in</span> cell_dict[i]:</div><div class="line">            j = cell_dict[i].index(<span class="number">1</span>)</div><div class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(j,m):</div><div class="line">                <span class="keyword">if</span> <span class="keyword">not</span> cell_dict[i][k]:</div><div class="line">                    cell_dict[i][k] = <span class="number">0</span></div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    <span class="keyword">continue</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">continue</span></div><div class="line">    <span class="keyword">return</span> cell_dict</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_excel</span><span class="params">(cell_dict,workbook,workbook_name)</span>:</span></div><div class="line">    n,m = len(cell_dict),len(cell_dict[<span class="number">1</span>])</div><div class="line">    worksheet = workbook.create_sheet(<span class="string">'Sheet2'</span>,<span class="number">0</span>)</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,n+<span class="number">1</span>):</div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,m+<span class="number">1</span>):</div><div class="line">            worksheet.cell(row=i,column=j,value=cell_dict[i][j<span class="number">-1</span>])</div><div class="line">    workbook.save(workbook_name)</div><div class="line">    <span class="keyword">print</span> <span class="string">"The data transform has been done successfully!"</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(workbook_path,sheet_name)</span>:</span></div><div class="line">    workbook,worksheet = get_workbook(workbook_path,sheet_name)</div><div class="line">    cell_dict = get_cell_content(worksheet)</div><div class="line">    cell_dict = update_cell_content(cell_dict)</div><div class="line">    write_excel(cell_dict,workbook,<span class="string">u"测试结果.xlsx"</span>)</div><div class="line">    <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    workbook_path,sheet_name = <span class="string">u'./测试.xlsx'</span>,<span class="string">'Sheet1'</span></div><div class="line">    main(workbook_path,sheet_name)</div></pre></td></tr></table></figure>
<hr>
<h3 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h3><p><a href="https://openpyxl.readthedocs.io/en/default/index.html" target="_blank" rel="external">OpenPyXL</a>  :  <a href="https://openpyxl.readthedocs.io/en/default/index.html" target="_blank" rel="external">https://openpyxl.readthedocs.io/en/default/index.html</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://fujiador.github.io/2017/04/24/《Python算法教程》读书笔记-（二）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Fujia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fujia's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/24/《Python算法教程》读书笔记-（二）/" itemprop="url">
                  《Python算法教程》读书笔记 - （二）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-24T09:11:27+08:00">
                2017-04-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>《Python Algorithms》主体内容是“数学技术”、“算法设计原则”和“经典算法”。</p>
<p>首先聚焦于两个话题：<strong>渐进记忆法(asymptotic notation)</strong>，关注运行时间的本质。另外就是<strong>树(tree)</strong>和<strong>图(graph)</strong>数据结构的Python实现方法。</p>
<p>算法，指包含能够解决某个特定问题的有限步骤集的执行过程。</p>
<hr>
<h3 id="渐进记忆法"><a href="#渐进记忆法" class="headerlink" title="渐进记忆法"></a>渐进记忆法</h3><p>在常数单位上的差距（通常取决于一些特定的事物，如编程语言的性能、硬件速度等），以及其在问题规模扩大时运行时间的增长幅度，才是研究算法分析时所要关心的中点。</p>
<p><strong>小插曲：</strong></p>
<blockquote>
<p>Python中的list不是传统意义上的列表，这即使append操作比insert操作高效的原因所在。<br>传统列表也叫做链表(linked list)，由一系列节点来实现，其每个结点(尾节点除外)中都持有一个指向下一节点的引用。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,value,next=None)</span>:</span></div><div class="line">		self.value = value</div><div class="line">		self.next = next</div><div class="line"><span class="comment"># 将所有节点构造成一个列表</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>L = Node(<span class="string">"a"</span>,Node(<span class="string">"b"</span>,Node(<span class="string">"c"</span>,Node(<span class="string">"d"</span>))))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>L.next.next.value</div><div class="line"><span class="string">'c'</span></div></pre></td></tr></table></figure></p>
<p>这是一个单向列表。双向列表的各节点中还需要持有一个指向前一节点的引用。<br>但Python中的list与此有些不同。Python的list不是由若干个独立的节点相互引用而成，而是一整块单一连续的内存区块，通常称为数组(array)。<br>尽管两者在遍历时的效率相差无几，但若按既定索引值对某元素进行直接访问的话，显然使用数组会更有效率！因为在数组中，可以直接计算出目标元素在内存中的位置，并能对其进行直接访问。而对于链表而言，必须从头开始遍历整个链表。</p>
<p>但具体到insert操作上，情况又会有所不同。对于链表而言，只要知道要在哪里执行insert操作，其操作成本非常低的。无论该列表中有多少元素，其操作时间大致上是相同的。而数组就不一样了，它每次执行insert操作都需要移动插入点右边所有元素，甚至在必要时，可能还需要将这些列表元素整体搬到一个更大的数组中去。<br>正因如此，append操作通常采用一种被称为<strong>动态数组或向量</strong>的特定解决方案，其主要想法是将内存分配的大一些，并且等到其溢出时，在线性时间内再次重新分配内存。<br>尽管两者情况都会迫使我们去搬动大量的元素，但主要的不用点在于，对append操作发生这样的可能性要小的多，如果能确保每次所搬入的数组都打过原数组一定的比例(20%甚至100%)，那么该操作的平均成本通常是常数的。</p>
</blockquote>
<hr>
<h4 id="时间复杂度定义"><a href="#时间复杂度定义" class="headerlink" title="时间复杂度定义"></a>时间复杂度定义</h4><p>通常，所获得的运行时间往往取决于某个特定基本操作被执的次数。</p>
<p>渐进记忆法记号分别是$O（大O）$、$Ω$、$\theta$。$O$记法所代表的其实是所谓的渐进上界，而$Ω$记法所代表的则是渐进下界，$\theta$正好是前两种记法的交集。</p>
<p>对于Python中的list而言，append n个数字所需要的运行时间约为$O(n)$，而在首端insert相同数量的数字需要的时间约为$O(n^2)$。</p>
<hr>
<h4 id="时间复杂度示例"><a href="#时间复杂度示例" class="headerlink" title="时间复杂度示例"></a>时间复杂度示例</h4><p>渐进记号最大限度的简化了数学问题，可以忽略乘法或加法中的那些常数，以及函数中其他<em>所有影响较小的部分</em>，从而让事情得到很大程度的简化。<br>下表给出一些时间复杂度对应的示例，并按照复杂度来排序，即每一行都要比它的前一行复杂。<br>$\theta(1)$         常数级            哈希表的查询与修改<br>$\theta(lg n)$         对数级        二分搜索<br>$\theta(n)$        线性级        列表的遍历<br>$\theta(n lg n)$        线性对数级            任意值序列的最优化排序<br>$\theta(n^2)$         平方级            n个对象相互比对<br>$\theta(n^3)$        立方级            Floyed-Warshall算法<br>$\theta(n^k)$        多项式级        基于n的k层嵌套循环<br>$\theta(k^n)$      指数级<br>$\theta(n{!})$      阶乘级</p>
<p>注：有的时间复杂度不理解，后续逐步深入学习</p>
<hr>
<h4 id="时间复杂度练习"><a href="#时间复杂度练习" class="headerlink" title="时间复杂度练习"></a>时间复杂度练习</h4><p>首先要考虑的是程序在时间复杂度与问题规模之间的关系。</p>
<p>例一：假设对大小为n的list，调用一次append的复杂度为$\theta(1)$，而调用一次insert(0,x)的复杂度则为$\theta(n)$。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">nums.append(<span class="number">1</span>)</div><div class="line">nums.insert(<span class="number">0</span>,<span class="number">2</span>)</div></pre></td></tr></table></figure></p>
<p>第一行时间复杂度为常数时间，当执行到第二行时，list的大小已经变成n+1，即现在的时间复杂度应该为$\theta(n+1)$，它与$\theta(n)$是等价的。总的运行时间就是这两种复杂度之和：$\theta(1) + \theta(n) = \theta(n)$。</p>
<p>例二：简单循环遍历n个元素序列。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">s = <span class="number">0</span></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> seq:		<span class="comment"># seqp = range(n)</span></div><div class="line">	s += x</div></pre></td></tr></table></figure></p>
<p>对seq中的n个元素都执行了常数时间操作，其运行时间应该是线性的，即$\theta(n)$，而初始化操作被站主导地位的循环操作忽略掉了。同样逻辑也使用与内嵌式循环代码中，例如列表解析式和生成器表达式。</p>
<p>例三：涉及嵌套循环时，单独每一层循环都是线性的，但层与层之间是依赖的关系，因此时间复杂度是线性的乘方的。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">s = o </div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> seq:</div><div class="line">	<span class="keyword">for</span> y <span class="keyword">in</span> seq:</div><div class="line">		s += x * y</div></pre></td></tr></table></figure></p>
<p>其实，基本的规则是：代码块的时间复杂度由其先后执行的语句累加而成；而嵌套循环的时间复杂度则在此基础上成本的增长。理由很简单：由于外层循环每执行一次，内循环都要完整执行一遍。此时，其时间复杂度相当于“线性级乘线性级”，即平方级，$\theta(n * n) = \theta(n^2)$。这种规则可以用于指代更多层嵌套，只需随之增加其乘方数值即可($\theta(n^k)$)！</p>
<p>例四：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">s = <span class="number">0</span></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> seq:</div><div class="line">	<span class="keyword">for</span> y <span class="keyword">in</span> seq:</div><div class="line">		s += x * y</div><div class="line">	<span class="keyword">for</span> z <span class="keyword">in</span> seq:</div><div class="line">		<span class="keyword">for</span> w <span class="keyword">in</span> seq:</div><div class="line">			s += x -w</div></pre></td></tr></table></figure></p>
<p>z循环是线性，且其中嵌套一个线性循环，此时时间复杂度是平方级$\theta(n^2)$；y循环时间复杂度是线性$\theta(n)$的。x循环的时间复杂度是$\theta(n(n^2 + n)) = \theta(n^3 + n^2) = \theta(n^3)$，即立方级。z循环在时间复杂度中占主导贡献。</p>
<p>例五：算出序列中各元素之间的乘积之和，要求是避免对象自身相乘或者同一乘积被累加两次的情况。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">s = <span class="number">0</span></div><div class="line">n = len(seq)</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-1</span>):</div><div class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>,n):</div><div class="line">		s += seq[i] * seq[j]</div><div class="line"><span class="comment">## 结果  seq = [1,2,3,4,5]</span></div><div class="line"><span class="number">1</span> <span class="number">2</span></div><div class="line"><span class="number">1</span> <span class="number">3</span></div><div class="line"><span class="number">1</span> <span class="number">4</span></div><div class="line"><span class="number">1</span> <span class="number">5</span></div><div class="line"><span class="number">2</span> <span class="number">3</span></div><div class="line"><span class="number">2</span> <span class="number">4</span></div><div class="line"><span class="number">2</span> <span class="number">5</span></div><div class="line"><span class="number">3</span> <span class="number">4</span></div><div class="line"><span class="number">3</span> <span class="number">5</span></div><div class="line"><span class="number">4</span> <span class="number">5</span></div></pre></td></tr></table></figure></p>
<p>时间复杂度是多少呢？</p>
<hr>
<h4 id="三种重要情况"><a href="#三种重要情况" class="headerlink" title="三种重要情况"></a>三种重要情况</h4><p>实际情况中，比如构建一个排序算法的话，我们可能这样的代码逻辑：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sort_w_check</span><span class="params">(seq)</span>:</span></div><div class="line">	n = len(seq)</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-1</span>):</div><div class="line">		<span class="keyword">if</span> seq[i] &gt; seq[i+<span class="number">1</span>]</div><div class="line">			<span class="keyword">break</span></div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="keyword">return</span> ...</div><div class="line"><span class="comment"># 在进行实际排序之前先做一个检查，如果目标序列已经排序，函数就直接返回。</span></div></pre></td></tr></table></figure></p>
<p>此种情况下，无论排序算法的效率多低，只要输入是已排序的序列，其时间复杂度始终是线性级的。而在一般情况下是没有排序算法能达到线性级运行时间的。此时所谓的“最好的情况”实际是一个异常情况。我们不能依据这个来预测可靠的时间复杂度。因此引出有关时间复杂度的三种重要情况：</p>
<ol>
<li><strong>最好的情况：</strong>算法在理想输入时的时间复杂度，此例中是线性级。</li>
<li><strong>最坏的情况：</strong>通常最有用的情况，希望对算法效率做出某些保证，此时最坏情况下的时间复杂度即是给出的最佳保证。</li>
<li><strong>平均情况：</strong>最复杂的情况，简而言之就是它是对于按照一定的概率分布的随机输入的期望运行时间。一般会回避这种情况。</li>
</ol>
<p>估计时间复杂度的基本原则：通常以最坏的情况下的时间复杂度为准，即直接选择上界或下界(用$O$或$Ω$)来描述问题。</p>
<hr>
<h4 id="算法工程与算法评估"><a href="#算法工程与算法评估" class="headerlink" title="算法工程与算法评估"></a>算法工程与算法评估</h4><p>算法工程(algorithm engineering)，即如何有效实现相关算法。</p>
<ol>
<li><strong>提示一：只要有可能，就不必去担心</strong>  对时间复杂度的担心可能很重要，但只要有可能就不必去担心。不妨试试先简单实现程序，然后再看看它是否足够好！如果感觉无从下手时，推荐蛮力算法。</li>
<li><strong>提示二：请用timeit模块来进行计算</strong>  timeit模块本身就是为执行相对可靠的计时操作而设计的！<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> timeit</div><div class="line"><span class="keyword">print</span> timeit.timeit(<span class="string">"l = range(1000)"</span>)</div><div class="line"><span class="comment">## 结果</span></div><div class="line"><span class="number">0.0169961213126</span></div><div class="line"><span class="number">6.22491721517</span></div><div class="line"></div><div class="line"><span class="comment"># 对封装的函数进行计时</span></div><div class="line">$ python -m timeit <span class="string">"import mymodule as m"</span> <span class="string">"m.myfunction()"</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>后续详细的学习下<code>timeit</code>模块。</p>
<ol>
<li><p><strong>提示3：请使用profiler找出瓶颈</strong>  确定自己的代码中需要优化的是哪一部分！使用<code>cProfiler</code>模块(trace模块)！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> cProfiler</div><div class="line"><span class="comment"># 自定义的主函数main(),结果打印出各函数的计时结果</span></div><div class="line">cProfiler.run(<span class="string">'main()'</span>)</div></pre></td></tr></table></figure>
</li>
<li><p><strong>绘制出结果</strong>  可视化往往是最好的工具。常见的是放映问题规模与运行时间关系的图表，或展示的相关运行时间的详细分布情况的图表。推荐<code>matplotlib</code>。<br>后续详细的学习下<code>matplotlib</code>模块。</p>
</li>
<li><strong>根据计时对比结果做出判断时要小心</strong>  </li>
</ol>
<p>我们进行时间复杂度分析的目的也主要是为了实现算法，以及在实际问题中运行算法时，能够对该算法的行为做出某些描述。</p>
<p>下一篇博客详细学习树和图数据结构！</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://fujiador.github.io/2017/04/20/smtplib-Python-操作SMTP服务/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Fujia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fujia's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/20/smtplib-Python-操作SMTP服务/" itemprop="url">
                  smtplib  Python 操作SMTP服务
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-20T23:45:45+08:00">
                2017-04-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>smtplib</code>模块定义了一个SMTP客户端会话对象，通过使用SMTP或ESMTP监听守护程序向互联网计算机发送邮件。</p>
<p>在日常工作中用到最多的核心class是<code>SMTP</code>。所以，今天的主题就是搞定<code>SMTP</code>。</p>
<h3 id="class-smtplibsmtp"><a href="#class-smtplib-SMTP" class="headerlink" title="class smtplib.SMTP"></a><code>class smtplib.SMTP</code></h3><p>SMTP实例将SMTP连接行为进行封装，支持完整的SMPT和ESMTP协议相关的操作方法，可选的参数<code>([host[, port[, local_hostname[, timeout]]]])</code>。官方文档也已经提示，平常的使用需求，一般只需要掌握初始化、connect、sendmail()和quit()方法即可。</p>
<p>简单的说明下<code>class smtplib.SMTP_SSL</code>类，其行为与<code>SMTP</code>实例行为完全相同，主要用在从连接开始就需要SSL的情况。接下来重点学习<code>SMTP</code>类及其方法。</p>
<hr>
<h3 id="smtp-方法"><a href="#SMTP-方法" class="headerlink" title="SMTP 方法"></a>SMTP 方法</h3><p><code>SMTP</code>类主要管理对SMTP或ESMTP服务器进行连接的方法。<code>SMTP</code>实例主要拥有以下方法：</p>
<ol>
<li><code>__init__(self,host=&#39;&#39;,port=0,local_hostname=None,timeout=&lt;object object&gt;)</code>：利用所给参数初始化一个新SMTP实例。</li>
<li><code>close(self)</code>：关闭与SMTP服务器的连接。</li>
<li><code>connect(self,host=&#39;localhost&#39;,port=0)</code>：连接到给定端口的主机上。如果主机名以冒号加数字结尾，且没有指定端口。会自动将冒号后的端口与主机名分离使用。</li>
<li><code>data(self,msg)</code>：将消息数据发送到服务器。</li>
<li><code>docmd(self,cmd,args=&#39;&#39;)</code>：发送命令并返回其响应代码值。在我的任务中没有用到。</li>
<li><code>getreply(self)</code>：从服务器获取答复，返回服务器响应代码。</li>
<li><code>login(self,user,password)</code>：登录需要身份验证的SMTP服务器，参数user即要认证的用户名，password是所需的验证密码。</li>
<li><code>mail(self,sender,option=[])</code>：开始邮件xfer会话。</li>
<li><code>quit(self)</code>：终止SMTP会话。</li>
<li><code>sendmail(self,from_addr,to_adder,msg,mail_options=[],rcpt_options=[])</code>：此命令执行整个邮件事务。from_addr即发送此邮件的地址；to_addr即收件人的地址列表；msg即要发送的消息。常见的一个异常是，收件人邮箱地址异常无法正常发送邮件，此方法会返回一个类似<code>{&quot;theuser@mail.com&quot;:(550,&quot;User unknown&quot;)}</code>字典。如有所有收件人地址都正常，返回一个孔字典。</li>
</ol>
<hr>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>核心的方法包括：connect、login、sendmail、close等。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#! -*- coding:utf-8 -*-</span></div><div class="line">__author__ = <span class="string">'MaFuJia'</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> smtplib</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">SendMail_Enterprise</span><span class="params">(AUTH_USER, AUTH_PASSWORD, from_addr, to_addrs, msg)</span>:</span></div><div class="line">    <span class="string">"""Send the email to email_addresses used by Tencent Enterprise Email Server</span></div><div class="line">    argments as following:</div><div class="line">        AUTH_USER : 登录SMTP服务器认证用户名</div><div class="line">        AUTH_PASSWORD : 认证用户的邮箱密码</div><div class="line">        from_addr : 发件人邮箱地址,要求发件人与认证用户一致</div><div class="line">        to_addr : 收件人列表</div><div class="line">    """</div><div class="line">    SMTP_HOST = <span class="string">'smtp.exmail.qq.com'</span></div><div class="line">    POSTFIX = <span class="string">'gmail.com'</span></div><div class="line">    mail_Server = smtplib.SMTP()</div><div class="line">    mail_Server.connect(SMTP_HOST)</div><div class="line">    mail_Server.login(AUTH_USER + <span class="string">'@'</span> + POSTFIX, AUTH_PASSWORD)</div><div class="line">    mail_Server.sendmail(from_addr, to_addrs, msg)</div><div class="line">    mail_Server.close()</div><div class="line">    <span class="keyword">return</span> <span class="string">u"Sending Emails Operation has been successful completed!"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main_Enterprise</span><span class="params">()</span>:</span></div><div class="line">    AUTH_USER = <span class="string">'user_name'</span></div><div class="line">    AUTH_PASSWORD = <span class="string">'password'</span></div><div class="line">    from_addr = <span class="string">'user_name@gmail.com'</span></div><div class="line">    to_addrs = [<span class="string">'user_name@gmail.com'</span>,<span class="string">'4006688**@qq.com'</span>]</div><div class="line">    msg = <span class="string">'hello world!'</span></div><div class="line"></div><div class="line">    SendMail_Enterprise(AUTH_USER, AUTH_PASSWORD, from_addr, to_addrs, msg)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">SendMail_Personal</span><span class="params">(AUTH_USER, AUTH_PASSWORD, from_addr, to_addrs, msg)</span>:</span></div><div class="line">    <span class="string">"""Send the email to email_addresses used by Tencent Personal Email Server</span></div><div class="line">    argments as following:</div><div class="line">        AUTH_USER : 登录SMTP服务器认证用户名</div><div class="line">        AUTH_PASSWORD : 认证用户的邮箱对应的授权码</div><div class="line">        from_addr : 发件人邮箱地址,要求发件人与认证用户一致</div><div class="line">        to_addr : 收件人列表</div><div class="line">    """</div><div class="line">    SMTP_HOST = <span class="string">'smtp.qq.com'</span></div><div class="line">    SMTP_PORT = <span class="number">25</span></div><div class="line">    POSTFIX = <span class="string">'qq.com'</span></div><div class="line">    mail_Server = smtplib.SMTP()</div><div class="line">    mail_Server.connect(SMTP_HOST, SMTP_PORT)</div><div class="line">    mail_Server.ehlo()</div><div class="line">    mail_Server.set_debuglevel(<span class="number">0</span>)</div><div class="line">    mail_Server.starttls()</div><div class="line">    mail_Server.ehlo()</div><div class="line">    mail_Server.login(AUTH_USER + <span class="string">'@'</span> + POSTFIX, AUTH_PASSWORD)</div><div class="line">    mail_Server.sendmail(from_addr, to_addrs, msg)</div><div class="line">    mail_Server.close()</div><div class="line">    <span class="keyword">return</span> <span class="string">u"Sending Emails Operation has been successful completed!"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main_Personal</span><span class="params">()</span>:</span></div><div class="line">    AUTH_USER = <span class="string">'406526***'</span></div><div class="line">    AUTH_PASSWORD = <span class="string">'*n*h*x*d*c*x*i*g'</span>    <span class="comment"># QQ邮箱16位授权码</span></div><div class="line">    from_addr = <span class="string">'406526***@qq.com'</span></div><div class="line">    to_addrs = [<span class="string">'user_name@gmail.com'</span>,<span class="string">'406526***@qq.com'</span>]</div><div class="line">    msg = <span class="string">'hello world!'</span></div><div class="line"></div><div class="line">    SendMail_Personal(AUTH_USER, AUTH_PASSWORD, from_addr, to_addrs, msg)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main_Enterprise()</div><div class="line">    main_Personal()</div></pre></td></tr></table></figure></p>
<hr>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="https://docs.python.org/2/library/smtplib.html" target="_blank" rel="external">https://docs.python.org/2/library/smtplib.html</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://fujiador.github.io/2017/04/16/pickle-cPickle-Python序列化对象/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Fujia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fujia's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/16/pickle-cPickle-Python序列化对象/" itemprop="url">
                  pickle & cPickle Python序列化对象
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-16T23:05:00+08:00">
                2017-04-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p><code>pickle &amp; cPickle</code>模块提供了一个基础但功能强大的算法，用于将Python对象数据结构序列化(serialization)和反序列化(de-serialization)。”pickling”是将Python对象层次结构转换为字节流的过程，”unpickling”是逆操作，即将字节流转换为Python对象层次结构。</p>
<hr>
<h3 id="与其他python模块的关系"><a href="#与其他Python模块的关系" class="headerlink" title="与其他Python模块的关系"></a>与其他Python模块的关系</h3><p><code>pickle</code>模块有一个优化后的类似模块<code>cPickle</code>，是用C编写的，比<code>pickle</code>快1000倍。但是在cPickle中不支持Pickler()和Unpickler()类的子类化，因为在cPickle中这些是函数，而不是类。两个模块提供的接口几乎是通用的，并且另个模块产生的数据流失可相互转换的。<br><code>pickle &amp; cPickle</code>模块始终是序列化Python对象的首选方式，<code>marshal</code>主要为了支持Python的”.pyc”文件。</p>
<blockquote>
<p>“pickle”模块持续跟踪已经被序列化的对象，以便后续再引用这些序列化的对象时不再进行重新序列化。当对同一个序列化对象有多个引用时，会发现对象共享。pickle只存储这样的对象一次，并确保其他引用毒性都是指向主副本。</p>
</blockquote>
<p>pickle模块可将复杂的Python对象转换成字节流，并且可以将字节流转换成具有相同原始结构的Python对象。对字节流李硕，最常见的处理方式就是讲他们写入文件，也可以将其通过网络传输存储在数据库中。</p>
<hr>
<h3 id="字节流格式"><a href="#字节流格式" class="headerlink" title="字节流格式"></a>字节流格式</h3><p><code>pickle</code>使用的数据格式是Python特点的。非Python程序可能无法将已经被序列化的字节流恢复成Python对象。</p>
<p>默认情况下，序列化数据格式使用可打印的ASCII表示。最大的优点在于，在调试或恢复被序列化的对象时，易于通过文本编辑器阅读。</p>
<p>目前有三种<code>protocols</code>格式应用于序列化：</p>
<blockquote>
<ol>
<li>协议版本0是指原始的ASCII协议，向后兼容早起版本的Python</li>
<li>协议版本1是指旧的二进制格式，向后兼容早起版本的Python</li>
<li>协议版本2是指在Python2.3后引入，提供了更高效的序列化新格式。<br>默认使用协议0。如果protocal参数被指定为负值或HIGHEST_PROTOCOL，则将使用可移动的最高协议版本。可通过<code>pickle.format_version</code>和<code>pickle.compatible_formats</code>分别查看当前协议版本和所有兼容的协议版本。</li>
</ol>
</blockquote>
<hr>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>序列化一个Python对象，首先创建一个pickler对象，然后调用<code>dump()</code>方法。反序列化一个字节流对象，首先创建一个unpickler对象，然后调用<code>load()</code>方法。<br><strong>pickle提供的变量：</strong></p>
<blockquote>
<p><code>pickle.HIGHEST_PROTOCOL</code> ：可兼容的最高协议版本</p>
</blockquote>
<p><strong>pickle提供的方法：</strong></p>
<blockquote>
<p><code>pickle.dump(obj, file [,protocal])</code>：将序列化的对象写入到文件中。等价于<code>Pickler(file, protocol).dump(obj)</code>。<br><code>pickle.load(file)</code> ：从文件中读取序列化的字节流，并将其转换返回原始Python对象。等效于<code>Unpickler(file).load()</code>。<br><code>pickle.dumps(obj, [,protocal])</code>：将Python对象序列化为字节流，并将其作为字符串返回，而不是写入到文件兑现中。<br><code>pickle.loads(string)</code>：读取序列化的字节流字符串对象，并将其恢复为Python对象。</p>
</blockquote>
<p><strong>pickle提供的类：</strong></p>
<blockquote>
<p><code>class pickle.Pickler(file[, protocol])</code>：将序列化后的字节流写入到文件对象。</p>
<blockquote>
<p><code>dump(obj)</code>：将Python的obj对象以序列化字节流的形式写入到文件对象中。可以对同一个Pickler实例的dump()方法进行多次调用。<br><code>clear_memo()</code>：清楚pickler的“memo”。<br><code>class pickle.Unpickler(file)</code>：从文件对象中读取序列化数据流。自动确定数据流是否是以二进制模式，不需要protocol参数。<br><code>load()</code>：读取序列化数据流对象并将其返回重构后的Python对象。自动确定数据流是否是以二进制模式，不需要protocol参数。</p>
</blockquote>
</blockquote>
<hr>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>其实比较核心的内容概括如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="string">"""</span></div><div class="line">Create portable serialized representations of Python object.</div><div class="line"># 创建Python对象的便携式序列化表示</div><div class="line"></div><div class="line">Classes:</div><div class="line">    Pickler</div><div class="line">    Unpickler</div><div class="line"></div><div class="line">Functions:</div><div class="line">    dump(object, file)</div><div class="line">    dumps(object) -&gt; string</div><div class="line">    load(file) -&gt; object</div><div class="line">    loads(string) -&gt; object</div><div class="line"></div><div class="line">Misc variables:</div><div class="line">    __version__</div><div class="line">    format_version</div><div class="line">    compatible_formats</div><div class="line">"""</div><div class="line"><span class="comment"># pickle.__doc__都已经说明</span></div><div class="line"><span class="keyword">print</span> pickle.__doc__</div></pre></td></tr></table></figure></p>
<p>示例1：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pickle</div><div class="line"><span class="keyword">import</span> pprint</div><div class="line"></div><div class="line">data = &#123;</div><div class="line">    <span class="string">'a'</span>:[<span class="number">1</span>,<span class="number">2.0</span>,<span class="number">3</span>,<span class="number">4</span>+<span class="number">6j</span>],</div><div class="line">    <span class="string">'b'</span>:(<span class="string">"Character string"</span>,<span class="string">b"byte string"</span>),</div><div class="line">    <span class="string">'c'</span>:&#123;<span class="keyword">None</span>,<span class="keyword">True</span>,<span class="keyword">False</span>&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">pprint.pprint(data)</div><div class="line"></div><div class="line"><span class="keyword">with</span> open(<span class="string">'data.pkl'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</div><div class="line">    pickle.dump(data, f, pickle.HIGHEST_PROTOCOL)</div><div class="line"><span class="comment"># data.pkl内容如下</span></div><div class="line">-------------------------------------</div><div class="line">�&#125;q (Uaq]q(KG@       Kc__builtin__</div><div class="line">complex</div><div class="line">qG@      G@      唓RqeUcqc__builtin__</div><div class="line">set</div><div class="line">q]q(増Ne卶	Rq</div><div class="line">UbqUCharacter stringqUbyte stringq</div><div class="line">唓u.</div><div class="line">-------------------------------------</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"*"</span>*<span class="number">66</span></div><div class="line"></div><div class="line"><span class="keyword">with</span> open(<span class="string">'data.pkl'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</div><div class="line">    data = pickle.load(f)</div><div class="line"></div><div class="line">pprint.pprint(data)</div><div class="line"><span class="comment"># data内容如下</span></div><div class="line">-------------------------------------</div><div class="line">&#123;<span class="string">'a'</span>: [<span class="number">1</span>, <span class="number">2.0</span>, <span class="number">3</span>, (<span class="number">4</span>+<span class="number">6j</span>)],</div><div class="line"> <span class="string">'b'</span>: (<span class="string">'Character string'</span>, <span class="string">'byte string'</span>),</div><div class="line"> <span class="string">'c'</span>: set([<span class="keyword">None</span>, <span class="keyword">False</span>, <span class="keyword">True</span>])&#125;</div><div class="line">-------------------------------------</div></pre></td></tr></table></figure></p>
<p>示例2：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">import pickle</div><div class="line"></div><div class="line">class Person(object):</div><div class="line">    def __init__(self, name, age):</div><div class="line">        self.name = name</div><div class="line">        self.age = age</div><div class="line">Bob = Person("Bob",26)</div><div class="line">print Bob</div><div class="line">&gt;&gt;&gt; &lt;__main__.Person object at 0x02BAA450&gt;</div><div class="line">print Bob.name</div><div class="line">&gt;&gt;&gt; Bob</div><div class="line">print Bob.age</div><div class="line">&gt;&gt;&gt; 26</div><div class="line"></div><div class="line">pickled_str =  pickle.dumps(Bob)</div><div class="line">print pickled_str </div><div class="line"># pickled_str 内容如下</div><div class="line">--------------------------------------</div><div class="line">ccopy_reg</div><div class="line">_reconstructor</div><div class="line">p0</div><div class="line">(c__main__</div><div class="line">Person</div><div class="line">p1</div><div class="line">c__builtin__</div><div class="line">object</div><div class="line">p2</div><div class="line">Ntp3</div><div class="line">Rp4</div><div class="line">(dp5</div><div class="line">S'age'</div><div class="line">p6</div><div class="line">I26</div><div class="line">sS'name'</div><div class="line">p7</div><div class="line">S'Bob'</div><div class="line">p8</div><div class="line">sb.</div><div class="line">--------------------------------------</div><div class="line"></div><div class="line">Bob_ = pickle.loads(pickled_str)</div><div class="line">print Bob_</div><div class="line">&gt;&gt;&gt; &lt;__main__.Person object at 0x02B3A530&gt;</div><div class="line"></div><div class="line">print 'Bob type is :',type(Bob)</div><div class="line">print 'Bob_ tyoe is :',type(Bob_)</div><div class="line">print Bob is Bob_</div><div class="line"></div><div class="line">Bob type is : &lt;class '__main__.Person'&gt;</div><div class="line">Bob_ tyoe is : &lt;class '__main__.Person'&gt;</div><div class="line">False</div></pre></td></tr></table></figure></p>
<hr>
<h3 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h3><p><a href="https://docs.python.org/2/library/pickle.html" target="_blank" rel="external">https://docs.python.org/2/library/pickle.html</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://fujiador.github.io/2017/04/10/KD-Tree算法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Fujia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fujia's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/10/KD-Tree算法/" itemprop="url">
                  KD Tree算法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-10T22:38:40+08:00">
                2017-04-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python-算法/" itemprop="url" rel="index">
                    <span itemprop="name">Python,算法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>k-d树（K-dimensional树的简称），是一种分割k维数据空间的数据结构。主要应用于多维空间关键数据的搜索（如，范围搜索和最近邻搜索）。</p>
<hr>
<h3 id="应用背景"><a href="#应用背景" class="headerlink" title="应用背景"></a>应用背景</h3><p>SIFT算法中特征点匹配的时候就会利用到k-d树。而特征点匹配实际上就是一个通过距离函数在高维矢量之间进行相似性检索的问题。针对如何快速而准确地找到查询点的近邻，现在提出了很多高位空间索引结构和近似查询的算法，kd树就是其中一种。<br>索引结构中相似性查询有两种基本的方式：一种是范围查询（range searches），另一种是k近邻查询（k-nerighbor searches）。范围查询就是给定查询点和查询距离的阈值，从数据集中找出所有与查询点距离小于阈值的数据；k近邻查询是给定查询点及正整数k，从数据集中找到距离查询点最近的k个数据点，当k=1时，就是最近邻查询（nearest neighbor searches）。</p>
<p>特征匹配算子大致可以分为两类。一类是线性扫描法，即将数据集中的点与查询点逐一进行距离比较，也就是穷举，缺点很明显，就是没有利用数据集本身蕴含的任何结构信息，搜索效率较低。第二类是建立数据索引，然后进行快速匹配。因为实际数据一般都会呈现出簇状的聚类形态，通过设计有效的索引结构可以大大加快检索的速度。</p>
<p>索引树属于第二类，其基本思想就是对搜索空间进行层次划分。根据划分的空间是否有混叠可以分为Clipping和Overlapping两种。前者划分空间没有重叠，其代表就是kd树；后者划分空间相互有交叠，其代表为R树。</p>
<hr>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>先以一个简单直观的实例来介绍kd树算法。</p>
<p>假设有6个二维数据点$\lbrace(2,3),(5,4),(9,6),(4,7),(8,1),(7,2)\rbrace$，数据点位于二维空间内（如图1中黑点所示）。kd树算法就是要确定图1中这些分割空间的分割线（多维空间即为分割平面，一般为超平面）。下面就要通过一步步展示kd树是如何确定这些分割线的。<br><img src="http://on58f12qv.bkt.clouddn.com/%E5%9B%BE1%20%E4%BA%8C%E7%BB%B4%E6%95%B0%E6%8D%AEkd%E6%A0%91%E7%A9%BA%E9%97%B4%E5%88%92%E5%88%86%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="图1 二维数据kd树空间划分示意图|center"></p>
<p>kd树宣发可以分为两大部分：一部分是有关kd树本身这种数据结构建立的算法，另一部分是在建立的kd树上如何进行最近邻查找的算法。</p>
<hr>
<h4 id="kd树构建算法"><a href="#kd树构建算法" class="headerlink" title="kd树构建算法"></a>kd树构建算法</h4><p>kd树是一个二叉树，每个节点表示一个空间范围。表1给出的是kd树每个节点主要包含的数据结构。<br><img src="http://on58f12qv.bkt.clouddn.com/kd%E6%A0%91%E7%A7%8D%E6%AF%8F%E4%B8%AA%E8%8A%82%E7%82%B9%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.png" alt="kd树种每个节点的数据结构|center|560x0"></p>
<p>从上面对kd树节点的数据类型的描述可以看出构建kd树是一个逐级展开的递归过程。表2给出的是构建kd树的伪代码：<br><img src="http://on58f12qv.bkt.clouddn.com/%E8%A1%A82%20%E6%9E%84%E5%BB%BAkd%E7%9A%84%E4%BC%AA%E4%BB%A3%E7%A0%81.png" alt="表2 构建kd的伪代码"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">算法：构建kd树（createKDTree）</div><div class="line">输入：数据点集Data-set和其所在的空间Range</div><div class="line">输出：kd，类型为kd Tree</div><div class="line"></div><div class="line">1. IF Data-set为空，则返回空的kd tree</div><div class="line">2. 调用节点生成程序：</div><div class="line">	(1)确定split域：对于所有描述自数据）特征矢量），统计它们在每个维上的数据方差。以SURF特征为例，描述子为64维，可计算64分方差。挑选出最大值，对应的维就是split域的值。数据方差大，表明沿该坐标轴方向上的数据分散的比较开，在这个方向上进行数据分割有较好的分辨率；</div><div class="line">	(2)确定Node-data域：数据点集Data-set按其split域的值排序。位于正中间的那个数据点被选为Node-data。此时新的Data-set&apos;=Data-set/Node-data（除去其中Node-data这一点）。</div><div class="line">3. </div><div class="line">dataleft = &#123;d属于Data-set&apos;  &amp;&amp; d[split] ≤ Node-data[split]&#125;</div><div class="line">Left_Range = &#123;Range &amp;&amp; dataleft&#125;</div><div class="line">dataright = &#123;d属于Data-set&apos; &amp;&amp; d[split] &gt; Node-data[split]&#125;</div><div class="line">Right_Range = &#123;Range &amp;&amp; dataright&#125;</div><div class="line">4. </div><div class="line">left = 由()datalef,Left_Range)建立的kd tree，即递归调用createKDTree(dataleft,Left_Range)。并设置left的parent域为KD；</div><div class="line">right = 由（dataright，Right_Range）建立的k-d tree，即调用createKDTree（dataleft，Left_ange）。并设置right的parent域为Kd。</div></pre></td></tr></table></figure>
<p>以上的实例来看，过程如下：</p>
<blockquote>
<p>由于此例简单，数据维度只有2维，所以可以简单地给x、y两个方向轴编号为0,1，即split={0,1}。</p>
<p>(1) 确定split域的首先该取的值。分别计算x,y方向上数据的方差得知x方向上的方差最大，所以split阈值首先取0，也就是x轴方向；</p>
<p>(2) 确定Node-data的阈值。根据x轴方向的值2,5,9,4,8,7排序选出中值为7，所以Node-data=(7,2)。这样，该节点的分割超平面就是通过(7,2)，并垂直于split=0（即x轴）的直线x=7；</p>
<p>(3) 确定左子空间和右子空间。分割超平面x=7将整个空间分为两部分，如图2所示。x≤7的部分为左子空间，包含3个节点$\lbrace(2,3),(5,4),(4,7)\rbrace$；另一部分为右子空间，包含两个节点$\lbrace(9,6),(8,1)\rbrace$。<br><img src="http://on58f12qv.bkt.clouddn.com/%E5%9B%BE2%20x=7%E5%B0%86%E6%95%B4%E4%B8%AA%E7%A9%BA%E9%97%B4%E5%88%86%E4%B8%BA%E4%B8%A4%E9%83%A8%E5%88%86.png" alt="图2 x=7将整个空间分为两部分|center"></p>
<p>(4) 在根节点对应的左子空间中，包含3个节点$\lbrace(2,3),(5,4),(4,7)\rbrace$。确定split域的首先该取的值。分别计算x,y方向上数据的方差得知y方向上的方差大，所以split阈值先取1，也就是y轴方向；</p>
<p>(5) 在左子空间中，确定Node-data的阈值。根据y轴方向的值3,4,7排序选出中值为4，所以Node-data=(5,4)。这样，该节点的分割超平面就是通过(5,4)，并垂直于split=1（即y轴）的直线y=4；</p>
<p>(6) 确定左子空间和右子空间。分割超平面y=4将上述左子空间分为两部分，并且每个空间内只包含一个节点，因此停止超平面分割的动作。y≤4的部分为左子空间，包含一个节点$\lbrace(2,3)\rbrace$，y&gt;4的部分为右子空间，包含一个节点$\lbrace(4,7)\rbrace$。</p>
<p>(7)在根节点对应的右子空间中，包含2个节点$\lbrace(9,6),(8,1)\rbrace$。确定split域的首先该取的值。分别计算x,y方向上数据的方差得知y方向上的方差大，所以split阈值先取1，也就是y轴方向；</p>
<p>(8) 在右子空间中，确定Node-data的阈值。根据y轴方向的值6,1排序选出中值为6，所以Node-data=(9,6)。这样，该节点的分割超平面就是通过(9,6)，并垂直于split=1（即y轴）的直线y=6；</p>
<p>(9) 分割超平面y=6将上述右子空间分为两部分，并且每个空间内只包含一个节点，因此停止超平面分割的动作。至此，kd树的构建完成。</p>
</blockquote>
<p>如算法所述，kd树的构建是一个递归的过程。然后对左子空间和右子空间内的数据重复根节点的过程就可以得到下一级子节点(5,4)和(9,6)（也就是左右子空间的根节点），同时将空间和数据集进一步细分。如此反复知道空间中只包含一个数据点，如图1所示，最后生成的kd树如图3所示：<br><img src="http://on58f12qv.bkt.clouddn.com/%E5%9B%BE3%20%E4%B8%8A%E8%BF%B0%E5%AE%9E%E4%BE%8B%E7%94%9F%E6%88%90%E7%9A%84kd%E6%A0%91.png" alt="图3 上述实例生成的kd树|center"><br>注：每一级节点旁边的x和y表示以该节点分割左右子空间时split所取的值。</p>
<hr>
<h4 id="kd树上的最近邻查找算法"><a href="#kd树上的最近邻查找算法" class="headerlink" title="kd树上的最近邻查找算法"></a>kd树上的最近邻查找算法</h4><p>在kd树种进行数据的查找也是特征匹配的重要环节，其目的是检索在kd中与查询点距离最近的数据点。这里先以一个简单的实例来描述最近邻查找的基本思路。</p>
<p>星号表示要查询的点(2.1,3.1)。通过二叉搜索，顺着搜索路径很快就能找到最近邻的近似点，也就是叶子节点(2,3)。而找到的叶子节点并不一定就是最近邻的，最近邻肯定距离查询点更近，应该位于以查询点为圆心且通过叶子节点的圆域内。</p>
<p>为了找到真正的最近邻，还需要进行“回溯”操作：算法沿搜索路径反向查找是否有距离查询点更近的数据点。</p>
<p>此例中先从(7,2)点开始进行二叉查找，然后到达(5,4)，最后到达(2,3)，此时搜索路径中的节点为&lt;(7,2),(5,4),(2,3)&gt;。首先以(2,3)作为当前最近邻点，计算其到查询点(2.1,3.1)的举例为0.1414，然后回溯到其父节点(5,4)，并判断在该父节点的其他子节点空间中是否有距离查询点更近的数据点。以(2.1,3.1)为圆心，以0.1414为半径画圆，如图所示。发现该圆并不和超平面y=4交割，因此不用进入(5,4)节点右子空间中去搜索。<br><img src="http://on58f12qv.bkt.clouddn.com/%E5%9B%BE4%20%E6%9F%A5%E6%89%BE%282.1,3.1%29%E7%82%B9%E7%9A%84%E4%B8%A4%E6%AC%A1%E5%9B%9E%E6%BA%AF%E5%88%A4%E6%96%AD.png" alt="图4 查找2.1,3.1点的两次回溯判断|center"><br>再回溯到(7,2)，以(2.1,3.1)为圆心，以0.1414为半径的圆更不会与x=7超平面交割，因此不用进入(7,2)右子空间进行查找。至此，搜索路径中的节点已经全部回溯完，结束整个搜索，返回最近邻点(2,3)，最近距离为0.1414。</p>
<p>一个复杂点例子如查找点为(2,4.5)。同样先进行二叉查找，先从(7,2)查找到(5,4)节点，在进行查找时由y=4为分割超平面的，由于查找点的y值为4.5，因此进入右子空间查找到(4,7)，形成搜索路径&lt;(7,2),(5,4),(4,7)&gt;，取(4,7)为当前最近邻点，计算其与目标查找点的举例为3.202。然后回溯到(5,4)，计算其与查找点之间的举例为3.041。以(2,4.5)为圆心，以3.041为半径作圆，如图5所示。<br><img src="http://on58f12qv.bkt.clouddn.com/%E5%9B%BE5%20%E6%9F%A5%E6%89%BE%282,4.5%29%E7%82%B9%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%9B%9E%E6%BA%AF%E5%88%A4%E6%96%AD.png" alt="图5 查找2,4.5点的第一次回溯判断|center"><br>课件该圆和y=4超平面交割，所以需要进入(5,4)左子空间进行查找。此时需要将(2,3)节点加入搜索路径中得&lt;(7,2),(2,3)&gt;。回溯至(2,3)叶子节点，(2,3)距离(2,4.5)比(5,4)要近，所以最近邻点更新为(2,3)，最近距离更新为1.5。回溯至(7,2)，以(2,4.5)为圆心1.5为半径作圆，并不和x=7分割超平面交割，如图6所示。至此，搜索路径回溯完。返回最近邻点(2,3)，最近距离1.5。kd树查询算法的伪代码如表3所示。<br><img src="http://on58f12qv.bkt.clouddn.com/%E5%9B%BE6%20%E6%9F%A5%E6%89%BE%282,4.5%29%E7%82%B9%E7%9A%84%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%9B%9E%E6%BA%AF%E5%88%A4%E6%96%AD.png" alt="图6 查找2,4.5点的第二次回溯判断|center"></p>
<p>表3 标准kd树查询算法<br><img src="http://on58f12qv.bkt.clouddn.com/%E8%A1%A83%20%E6%A0%87%E5%87%86kd%E6%A0%91%E6%9F%A5%E8%AF%A2%E7%AE%97%E6%B3%95-1.png" alt="表3 标准kd树查询算法-1|center"><br><img src="http://on58f12qv.bkt.clouddn.com/%E8%A1%A83%20%E6%A0%87%E5%87%86kd%E6%A0%91%E6%9F%A5%E8%AF%A2%E7%AE%97%E6%B3%95-2.png" alt="表3 标准kd树查询算法-2|center"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">算法：kd树最近邻查找</div><div class="line">输入：kd，	//kd tree类型</div><div class="line">	 target //查询数据定</div><div class="line">输出：nearest   //最近邻数据点</div><div class="line">     dist      //最近邻数据点和查询点间的距离</div><div class="line">1. IF kd为NULL，则设dist为infinite并返回</div><div class="line">2. //进行二叉查找，生成搜索路径</div><div class="line">	Kd_point = &amp;Kd;        //Kd-point中保存kd tree根节点地址</div><div class="line">	nearest = Kd_point -&gt; Node-data;    // 初始化最近邻点</div><div class="line">	while (Kd_point)</div><div class="line">		push(Kd_point) 到 search_path中;   //search_path是一个堆栈结构，存储着搜索路径节点指针</div><div class="line">/*** IF Dist(nearest,target) &gt; Dist(Kd_point -&gt; Node-data,target)</div><div class="line">	nearest = Kd_point -&gt; Node-data;    //更新最近邻点</div><div class="line">	Max_dist = Dist(Kd_point,target);    //更新最近邻点与查询点间的距离***/</div><div class="line">		s = Kd_point -&gt; split;    //确定待分割的方向</div><div class="line">		If target[s] &lt;= Kd_point -&gt;Node-data[s]</div><div class="line">			Kd_point = Kd_point -&gt; left;</div><div class="line">		else</div><div class="line">			Kd_point = Kd_point -&gt; right;</div><div class="line">	nearest = search_path中最后一个叶结点; //注意：二叉搜索时不必计算选择搜索路径中的最近邻点，这部分已被注释</div><div class="line">	Max_dist = Dist(nearest,target);    //直接取最后叶子节点作为回溯前的初始最近邻点</div><div class="line">3. // 回溯查找</div><div class="line">    while (search_path != NULL)</div><div class="line">	    back_point = 从search_path取出一个节点指针;    //从search_path堆栈弹栈</div><div class="line">	    s = back_point -&gt; split;    //确定分割方向</div><div class="line">	    If Dist(target[s],back_point -&gt; Node-data[s]) &lt; Max_dist    //判断还需进入的子空间</div><div class="line">		    If target[s] &lt;=  back_point -&gt; Node-data[s]</div><div class="line">			    Kd_point = back_point -&gt; right;    //如果target位于左子空间，就应进入右子空间</div><div class="line">		    else</div><div class="line">			    Kd_point = back_point -&gt; left;    //如果target位于右子空间，就应该进入左子空间将Kd_point压入search_path堆栈;</div><div class="line">		If Dist(nearest,target) &gt; Dist(Kd_point -&gt; Node-data,target)</div><div class="line">			nearest = Kd_point -&gt; Node-data;    //更新最近邻点</div><div class="line">			Min_dist = Dist(Kd_point -&gt; Node-data,target);    //更新最近邻点与查询点间的距离</div></pre></td></tr></table></figure></p>
<p>上述两次实例表明，当查询点的领域与分割超平面两侧空间交割时，需要查找另一侧子空间，导致检索过程复杂，效率下降。研究表明N个节点的k维kd树搜索过程时间复杂度为：$t_{worst}=O(kN^{1-1/k})$。</p>
<hr>
<h3 id="复杂度分析"><a href="#复杂度分析" class="headerlink" title="复杂度分析"></a>复杂度分析</h3><p>对于拥有n个已知点的kd-Tree，其复杂度如下：<br>构建：$O(log 2n)$<br>插入：$O(log n)$<br>删除：$O(log n)$<br>查询：?</p>
<hr>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>以上为了介绍方便，讨论的是二维情形。实际的应用中，维度都比较大，直接利用kd树快速检索的性能急剧下降。其中一个比较著名的就是Best-Bin-First，它通过设置有限级队列和运行超时限定来获取近似的最近邻，有效地减少回溯的次数。假设数据集的维数为D，一般来说要求数据的规模N满足$N&gt;&gt;2^D$，才能达到高效的搜索。</p>
<hr>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><strong>[转载]</strong> <a href="http://www.cnblogs.com/eyeszjwang/articles/2429382.html" target="_blank" rel="external">http://www.cnblogs.com/eyeszjwang/articles/2429382.html</a><br><a href="https://en.wikipedia.org/wiki/K-d_tree" target="_blank" rel="external">https://en.wikipedia.org/wiki/K-d_tree</a><br><a href="http://baike.baidu.com/item/kd-tree" target="_blank" rel="external">http://baike.baidu.com/item/kd-tree</a><br><a href="http://www.aichengxu.com/suanfa/10987660.htm" target="_blank" rel="external">http://www.aichengxu.com/suanfa/10987660.htm</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://fujiador.github.io/2017/04/10/《Python算法教程》读书笔记-（一）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Fujia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fujia's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/10/《Python算法教程》读书笔记-（一）/" itemprop="url">
                  《Python算法教程》读书笔记 - （一）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-10T01:23:45+08:00">
                2017-04-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="自说自话"><a href="#“自说自话”" class="headerlink" title="“自说自话”"></a>“自说自话”</h3><p>这部分的内容，暂时与算法与数据结构无关。</p>
<p>在毕业之后，偶然的机缘，进入数据这个职业。到现在方向一直是数据分析。随着近几年大数据和深度学习的概念的热度越来越高，以及数据这个行业的高速、日新月异的发展变化，越发的体会到数据相关行业技术革新的极其迅速，并且对数据分析的从业人员的要求越来越深入并且全面。</p>
<p>“数据”相关的岗位以及行业，定位一定是<strong>立足于精通业务</strong>的基础上，通过全面的<strong>技能获取准确的数据信息</strong>，来获取海量数据中的知识信息，并且再两者基础之上，制定出合理以及可落地执行、可考核优化的<strong>行动决策</strong>，三个环节所形成的闭环模型。</p>
<p>其中的每个环节，都对应需要与其匹配的能力来支撑，并且这个闭环模型，需要不断的从外部吸收新鲜的知识和技能，不断的巩固这个闭环模型的稳定性、高效性。</p>
<p>从一个职场的数据小菜鸟，在不断的爬坑、摸索、调整的过程中，深刻的认识到：扎实的基础能力、敏锐的业务能力、精通的编码能力，是一个高级的数据分析人员必备的基础条件。在这里，称为“基础条件”并无贬低或其他的意思，只为突出其极其重要的地位（在这里不排序这些能力的重要优先级）。在这个方向的中后阶段，需要从一个常规的统计型数据分析，转向数据挖掘，进一步深入到机器学习、深度学习的方向。当然，并不是所有的数据分析都需要这样的一个职业规划，这些只是就我个人而言，对自己的一些认知和规划。</p>
<p>现在，越来越多的开源以及数据或云服务机构和公司，将其研发或研究成果落地化、产品化。机器学习、深度学习这些知识和技能必将是将来数据行业的热门方向。无论从事什么行业，必然会接触到这些内容，其中最基础、最核心的就是各种各样的算法模型，而算法模型的核心即算法与数据结构，因此，这个就是我个人规划职业方向中，需要填充的一个知识和技能点。</p>
<p>作为一个小菜鸟，也看了关于机器学习相关的算法、应用，但是总是感觉迷茫，并且只是作为一种“code搬运工”或“python importor”，简而言之，学的东西肤浅、理解不深入、不会灵活运用、无法工程化等等你可以想象到一切负面的词，来描述我当前的这种状况和感受。于是，最终狠心决定，踏实学习算法和数据结构这些基础内容。</p>
<p>我知道，并非是学习一遍“算法和数据结构”内容，就能够如何如何。但与其迷茫和职业瓶颈，还不如小步挪动，谁知道路的终点会是什么样子呢，总之先加油努力吧！<br><img src="http://on58f12qv.bkt.clouddn.com/%E8%B6%8A%E5%8A%AA%E5%8A%9B%E8%B6%8A%E5%B9%B8%E8%BF%90.jpg" alt="努力|center|580x0"></p>
<hr>
<h3 id="内容提要"><a href="#内容提要" class="headerlink" title="内容提要"></a>内容提要</h3><p>《Python Algorithms》</p>
<p>主要介绍经典的算法，分别是树、图、计数问题、归纳递归、遍历、分解合并、贪心算法、复杂依赖、Dijkstra算法、匹配切割问题以及困难问题及其稀释等内容。<br>作者是挪威的 <em>Magnux Lie Hetland</em>，请支持正版书籍。</p>
<p>本博客的顺序不一定会按照目录的顺序进行，主要是依据自己遇到的实际问题，以问题驱动的方式学习，当写下博文时并不代表我已经完全弄懂相关的知识，会在疑问的地方进行标记。</p>
<hr>
<h3 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h3><ol>
<li>提出“旅行商问题traveling salesman”（或推销员问题salesrep）</li>
<li>提出“最短路径问题 shorted path”</li>
</ol>
<p>总体的学习思路是：提出问题<code>-&gt;</code>分析问题困难所在<code>-&gt;</code>掌握高效的解决方案。</p>
<hr>
<h4 id="涉及主要内容"><a href="#涉及主要内容" class="headerlink" title="涉及主要内容"></a>涉及主要内容</h4><ul>
<li>算法分析，侧重运行时间分析</li>
<li>算法设计的基本原则</li>
<li>如何用Python描述那些常用的数据结构</li>
<li>如何用Python实现那些知名的算法</li>
</ul>
<h4 id="为什么要读这本书"><a href="#为什么要读这本书" class="headerlink" title="为什么要读这本书"></a>为什么要读这本书</h4><p>在工作中使用算法时，我们都希望有效、高效的解决方案。首先，我们要担心的并不是常数级别的性能差异（可理解为同样的数据、同样正确的算法逻辑，用C++、Java执行效率要高于Python。尤其当输入内容足够大时，可能在一定程度上由编程语言带来的效率优势已经变得相对次要）。<strong>实际上，扎实的算法设计功底是抑制运行时间增长的主要武器！</strong>。<br>例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">count = <span class="number">10</span> ** <span class="number">5</span></div><div class="line">nums = []</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(count):</div><div class="line">	nums.append(i)</div><div class="line">nums.reverse()  <span class="comment"># 在完nums列表后，才进行倒序反转</span></div></pre></td></tr></table></figure></p>
<p>这段代码只是简单的反转数字序列列表，实际情况下，可能是某些外部数据源，为实现最近优先的原则，希望数字列表添加到列表中的顺序是相反的。换个想法来解决：与其最后才将整个数字列表反转，何不在数字出现的时候就将它插入到列表的头部？<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">nums = []</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(count):</div><div class="line">	nums.insert(<span class="number">0</span>,i)   <span class="comment"># list.insert(index,object)方法 index=where the obj need to be inserted</span></div></pre></td></tr></table></figure></p>
<p>除非遇到过类似的情况，否则一定会觉得这段新代码看上去很不错。但实际情况发现其速度反而是<strong>明显变慢</strong>了。经过测试如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"># 环境 win7 64位</div><div class="line"># 内存 16GB</div><div class="line"># CPU i5-4590 3.30GHz</div><div class="line"># Python 2.7.10</div><div class="line"></div><div class="line">## append是线性增长</div><div class="line">## insert是二次方增长</div><div class="line"></div><div class="line">The 100 ** 1 </div><div class="line">the append() method takes 0.0 </div><div class="line">the insert() method takes 0.0 </div><div class="line">The 100 ** 2 </div><div class="line">the append() method takes 0.00200009346008 </div><div class="line">the insert() method takes 0.0209999084473 </div><div class="line">The 100 ** 3 </div><div class="line">the append() method takes 0.161000013351 </div><div class="line">the insert() method takes 195.611000061 </div><div class="line"></div><div class="line">The 100 ** 4 </div><div class="line">Traceback (most recent call last):</div><div class="line">  File &quot;D:/Pycharm/Git_Project/NLP/NLTKs/chapter_1.py&quot;, line 14, in &lt;module&gt;</div><div class="line">    nums.append(i)</div><div class="line">MemoryError</div></pre></td></tr></table></figure></p>
<p>从结果数据来看，不仅仅是速度变慢了，对应问题规模的性能弹性也更差了。并且随着问题的规模持续扩大，这两个版本效率的差距只会越来越大。<br>此时，用意是说明，选择正确的算法比任何时候都要来的更重要。之后才是在算法正确的基础上通过编程语言的选择进一步优化效率。</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>程序设计不仅仅是软件架构及面向对象设计方面的事情，算法设计问题也是它要解决的一个方面。本书将致力于知名算法与常用设计原则。</p>
<hr>
<h3 id="练习题"><a href="#练习题" class="headerlink" title="练习题"></a>练习题</h3><blockquote>
<p>练习题答案后续补充<br>1.1 思考这句话“随着及其的速度越来越快，内存越来越便宜。算法的重要性会越来越低”，您觉得这句话说的对吗？为什么？<br>1.2 请找出一种方法，使得能检查出两个字符串之间是否存在着字符变位（比如“debit card”与“bad credit”）。您提出的解决方案性能弹性如何？能想出一个性能弹性非常糟糕的、朴素的解决方案吗？</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://fujiador.github.io/2017/04/09/ConfigParser-Python解析配置文件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Fujia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fujia's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/09/ConfigParser-Python解析配置文件/" itemprop="url">
                  ConfigParser  Python解析配置文件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-09T20:05:43+08:00">
                2017-04-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>ConfigParser</code>，如其名即配置文件解析模块(Configuration file parser module)。注意，在Python 3.x中，对应功能的模块被重命名为<code>configparse</code>。</p>
<h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><hr>
<h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>ini是Initialization File的缩写(windows环境)，cfg是Configuration File的缩写(Linux或UNIX环境)，均指初始化文件，使操作系统或程序进行初始化或进行参数设置。</p>
<p>为什么要用配置文件呢？从我个人当前工作中遇到的问题(例如读取很多个数据库)看，如果程序没有配置文件，对外是相对封闭的，如果程序(如数据库)的参数进行了修改，必须要修改程序代码以及重新编译才可。这样效率差且容易出错。此时使用配置文件，将参数的修改集中在内，程序调用配置文件内对应功能或模块的参数即可，以达到统一管理参数的作用。</p>
<blockquote>
<p>注：还有其他类型的配置文件，当前主要考虑Windows .ini文件和Ubuntu .cfg文件。实际配置文件就是常规的text文件，只是其遵循一定的文件语法格式。<br>以下统称为配置文件。</p>
</blockquote>
<hr>
<h4 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h4><p><strong>格式很简单，三大基本要素：paramters、sections和comments</strong></p>
<p>配置文件是由section和参数 name &amp; value 组成。</p>
<ul>
<li>[section]：直观的理解就是节或部分，某些参数形成的块</li>
<li>name = value：对应的[section]下的参数</li>
</ul>
<p>同一配置文件内可以存在多个<code>[sections]</code>以便提供项目使用。</p>
<p><strong>parameters</strong><br>最基本的元素就是parameters，每个parameter都有一个name和value，name和value由 ‘=’ 隔开，例如<em>name = value</em>。<br><strong>sections</strong><br>所有parameters都是以sections为单位结合在一起。section名称独占一行，例如<em>[section name]</em>，且由方括号包围。在section申明后的所有parameters都是属于该section。section没有显式的结束标志符，下一个<strong>新</strong> section开始即上一个<strong>老</strong> section的结束。<br><strong>comments</strong><br>注释以<code>;</code>标记开始，所有的注释语句不管多次都是独占一行直到结束，即在分号和行结束符之间的所有内容均被忽略，例如<em>; comments text</em><br><strong>如下示例：</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">; last modified at 2017-4-7 01:19:25 by Dor</div><div class="line">[DataBase_MySQL_business]</div><div class="line">server = 127.0.0.1</div><div class="line">user = user_name</div><div class="line">passwd = pass_word</div><div class="line">port = 3306</div><div class="line">charset = <span class="string">'gbk'</span></div><div class="line"></div><div class="line">; last modified at 2017-4-7 01:19:25 by Dor</div><div class="line">[DataBase_MySQL_log]</div><div class="line">server = 127.0.0.1</div><div class="line">user = user_name</div><div class="line">passwd = pass_word</div><div class="line">port = 3306</div><div class="line">charset = <span class="string">'gbk'</span></div></pre></td></tr></table></figure></p>
<hr>
<h3 id="configparser模块"><a href="#ConfigParser模块" class="headerlink" title="ConfigParser模块"></a>ConfigParser模块</h3><p>常用到的主要是三大类：<code>ConfigParser.RawConfigParser()</code>,<code>ConfigParser.ConfigParser()</code>,<code>ConfigParser.SafeConfigParser()</code>,其他主要是一些Error异常类。</p>
<ul>
<li><code>[defaults[, dict_type[, allow_no_value]]]</code>：When defaults is given, it is initialized into the dictionary of intrinsic defaults. When dict_type is given, it will be used to create the dictionary objects for the list of sections, for the options within a section, and for the default values. When allow_no_value is true (default: False), options without values are accepted; the value presented for these is None。</li>
</ul>
<hr>
<h4 id="rawconfigparser"><a href="#RawConfigParser" class="headerlink" title="RawConfigParser"></a>RawConfigParser</h4><p>RawConfigParser实例包含以下方法：</p>
<blockquote>
<p><code>.defaults()</code>：返回包含默认的实例字典类型，OrderedDict()<br><code>.sections()</code>：返回配置文件内的section列表<br><code>.add_section(section)</code>：为配置文件实例增加section名<br><code>.has_section(section)</code>：判断section名是否存在<br><code>.options(section)</code>：返回对应section的属性名列表<br><code>.has_option(section, option)</code>：判断属性名是否存在section节内<br><code>.read(filenames)</code>：读取和解析文件名列表，返回成功解析的文件名列表<br><code>.readfp(fp[,filename])</code>：读取和解析文件或类文件fp对象，并制定文件名<br><code>.get(section,option)</code>：获取section下对应option属性值<br><code>.getint(section,option)</code><br><code>.getfloat(section,option)</code><br><code>.getboolean(section,option)</code>：以上三个方法都是将section下option的属性值格式化<br><code>.items(section)</code>：返回对应section下的(name,value)对列表<br><code>.set(section,option,value)</code>：添加或修改section下对应option的属性值<br><code>.write(fileobject)</code>：将指定配置写入对应文件对象，可由read()解析<br><code>.remove_option(section,option)</code>：删除section下对应的option内容<br><code>.remove_section(section)</code>：删除对应的section内容</p>
</blockquote>
<h4 id="configparser"><a href="#ConfigParser" class="headerlink" title="ConfigParser"></a>ConfigParser</h4><p>ConfigParser在RawConfigParser基础上扩展了一些方法，增加了一些可选参数。</p>
<blockquote>
<p><code>.get(section, option[, raw[, vars]])</code>：获取section下对应option的属性值。如果提供vars参数(必须是字典类型)，option属性值在会在vars参数中查找。如果raw=0，即不使用raw mode模式，在属性值中的“%”进行对应的替换，如果raw=1，即使用raw mode模式，输出原始的option值，不进行对应的替换。<br><code>.items(section[,raw[,vars]])</code>：返回对应section下的(name,value)对列表，其参数与get方法中参数的意义一致。</p>
</blockquote>
<p>示例：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#! -*- coding:utf-8 -*-</span></div><div class="line">__author__ = <span class="string">'FuJiaDor'</span></div><div class="line"><span class="keyword">import</span> ConfigParser</div><div class="line"><span class="keyword">import</span> io</div><div class="line"></div><div class="line">config = ConfigParser.RawConfigParser()</div><div class="line"><span class="comment"># 1. write configuration section into file</span></div><div class="line">config.add_section(<span class="string">'Section1'</span>)</div><div class="line">config.set(<span class="string">'Section1'</span>,<span class="string">'an_int'</span>,<span class="string">'15'</span>)</div><div class="line">config.set(<span class="string">'Section1'</span>,<span class="string">'a_bool'</span>,<span class="string">'true'</span>)</div><div class="line">config.set(<span class="string">'Section1'</span>,<span class="string">'a_float'</span>,<span class="string">'3.1415'</span>)</div><div class="line">config.set(<span class="string">'Section1'</span>,<span class="string">'baz'</span>,<span class="string">'fun'</span>)</div><div class="line">config.set(<span class="string">'Section1'</span>,<span class="string">'bar'</span>,<span class="string">'Python'</span>)</div><div class="line">config.set(<span class="string">'Section1'</span>,<span class="string">'foo'</span>,<span class="string">'%(bar)s is %(baz)s!'</span>)  <span class="comment"># 注意这里option属性值的形式,是格式化字符串的形式</span></div><div class="line"></div><div class="line"><span class="keyword">with</span> open(<span class="string">'example.cfg'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> config_file:</div><div class="line">    config.write(config_file)</div><div class="line"></div><div class="line"><span class="comment"># 2. read configuration form section</span></div><div class="line">config = ConfigParser.RawConfigParser()</div><div class="line">config.read(<span class="string">'example.cfg'</span>)</div><div class="line">a_float = config.getfloat(<span class="string">'Section1'</span>,<span class="string">'a_float'</span>)</div><div class="line">an_int = config.getint(<span class="string">'Section1'</span>,<span class="string">'an_int'</span>)</div><div class="line"><span class="keyword">print</span> a_float + an_int</div><div class="line"></div><div class="line"><span class="comment"># notice that the next output does not interpolate '%(bar)s is %(baz)s!'</span></div><div class="line"><span class="comment"># this is because we are using a RawConfigParser().</span></div><div class="line"><span class="keyword">if</span> config.getboolean(<span class="string">'Section1'</span>,<span class="string">'a_bool'</span>):</div><div class="line">    <span class="keyword">print</span> config.get(<span class="string">'Section1'</span>,<span class="string">'foo'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>%(bar)s <span class="keyword">is</span> %(baz)s!</div><div class="line"></div><div class="line"><span class="comment"># 对比说明ConfigParser.get(section,option[,raw[,vars])</span></div><div class="line">config = ConfigParser.ConfigParser()</div><div class="line">config.read(<span class="string">'example.cfg'</span>)</div><div class="line"></div><div class="line"><span class="comment"># set the third optional argument of get to 1 if you wish to use raw mode</span></div><div class="line"><span class="keyword">print</span> config.get(<span class="string">'Section1'</span>,<span class="string">'foo'</span>,<span class="number">0</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>Python <span class="keyword">is</span> fun!</div><div class="line"><span class="keyword">print</span> config.get(<span class="string">'Section1'</span>,<span class="string">'foo'</span>,<span class="number">1</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>%(bar)s <span class="keyword">is</span> %(baz)s!</div><div class="line"></div><div class="line"><span class="comment"># the optional fourth argument is a dict with members that will take precedence in interpolation</span></div><div class="line"><span class="keyword">print</span> config.get(<span class="string">'Section1'</span>,<span class="string">'foo'</span>,<span class="number">0</span>,&#123;<span class="string">'bar'</span>:<span class="string">'Documentation'</span>,<span class="string">'baz'</span>:<span class="string">'evil'</span>&#125;)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>Documentation <span class="keyword">is</span> evil!</div><div class="line"><span class="keyword">print</span> config.get(<span class="string">'Section1'</span>,<span class="string">'foo'</span>,<span class="number">1</span>,&#123;<span class="string">'bar'</span>:<span class="string">'Documentation'</span>,<span class="string">'baz'</span>:<span class="string">'evil'</span>&#125;)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>%(bar)s <span class="keyword">is</span> %(baz)s!</div></pre></td></tr></table></figure></p>
<h4 id="safeconfigparser"><a href="#SafeConfigParser" class="headerlink" title="SafeConfigParser"></a>SafeConfigParser</h4><p>SafeConfigParser类同样是ConfigParser类的扩展。</p>
<blockquote>
<p><code>.set(section,option,value)</code>：如果给定的section存在，则将option属性值修改为value，value必须为string类型，否则报错。</p>
</blockquote>
<hr>
<h3 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#! -*- coding:utf-8 -*-</span></div><div class="line"><span class="keyword">import</span> ConfigParser</div><div class="line"><span class="comment"># ConfigParser类最核心的方法</span></div><div class="line"></div><div class="line">config = ConfigParser.ConfigParser()  <span class="comment"># create ConfigParser instance</span></div><div class="line">config.sections()   <span class="comment"># return the sections list of the config file</span></div><div class="line">config.options(section)   <span class="comment"># return the options list of the section config</span></div><div class="line">config.get(section,option)   <span class="comment"># return the option's value</span></div><div class="line">config.add_section(section_name)   <span class="comment"># add a sction </span></div><div class="line">config.set(section,option,value)   <span class="comment"># add the option ,value pairs</span></div><div class="line">config.read(filename)   <span class="comment"># read the config file</span></div><div class="line">config.write(object_file)    <span class="comment"># write the config information into file or file_like object</span></div></pre></td></tr></table></figure>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#! -*- coding:utf-8 -*-</span></div><div class="line"><span class="keyword">import</span> ConfigParser</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_Config</span><span class="params">(file_name,section,*args)</span>:</span></div><div class="line">	config = ConfigParser.ConfigParser()</div><div class="line">	config.add_section(section)</div><div class="line">	host,user,passwd,db,charset,port = args</div><div class="line">	config.set(section,<span class="string">'host'</span>,host)</div><div class="line">	config.set(section,<span class="string">'user'</span>,user)</div><div class="line">	config.set(section,<span class="string">'passwd'</span>,passwd)</div><div class="line">	config.set(section,<span class="string">'db'</span>,db)</div><div class="line">	config.set(section,<span class="string">'charset'</span>,charset)</div><div class="line">	config.set(section,<span class="string">'port'</span>,port)</div><div class="line"></div><div class="line">	<span class="keyword">with</span> open(file_name,<span class="string">'a+'</span>) <span class="keyword">as</span> config_file:</div><div class="line">		config.write(config_file)</div><div class="line">	<span class="keyword">return</span> <span class="string">'The config information has been writed successfully!'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_Config</span><span class="params">(file_name,section,**kwargs)</span>:</span></div><div class="line">	config = ConfigParser.ConfigParser()</div><div class="line">	config.read(file_name)</div><div class="line">	<span class="keyword">try</span>:</div><div class="line">		<span class="keyword">for</span> option,value <span class="keyword">in</span> kwargs.items():</div><div class="line">			config.set(section,option,value)</div><div class="line">		<span class="keyword">with</span> open(file_name,<span class="string">'wb'</span>) <span class="keyword">as</span> config_file:	</div><div class="line">			config.write(config_file)</div><div class="line">		<span class="keyword">return</span> <span class="string">"The config file has been updated successfully!"</span></div><div class="line">	<span class="keyword">except</span> Exception,e:</div><div class="line">		<span class="keyword">return</span> <span class="string">"The config file updated failed.the Error is '%s'"</span> % e</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">	file_name = <span class="string">'mysql.config'</span></div><div class="line">	section = <span class="string">'mysql_boss'</span></div><div class="line">	<span class="keyword">print</span> write_Config(file_name,section,<span class="string">'127.0.0.1'</span>,<span class="string">'user'</span>,<span class="string">'passwd'</span>,<span class="string">'report'</span>,<span class="string">'gbk'</span>,<span class="string">'3306'</span>)</div><div class="line">	<span class="keyword">print</span> update_Config(file_name,section,host=<span class="string">'127.0.0.0'</span>)		</div><div class="line"> </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>The config information has been writed successfully!</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>The config file has been updated successfully!</div></pre></td></tr></table></figure>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#! -*- coding:utf-8 -*- </span></div><div class="line"><span class="keyword">import</span> ConfigParser</div><div class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_Config_Infor</span><span class="params">(config_file_path, section)</span>:</span></div><div class="line">	config = ConfigParser.ConfigParser()</div><div class="line">	config.read(config_file_path)</div><div class="line"></div><div class="line">	option_result = OrderedDict()</div><div class="line">	<span class="keyword">for</span> option <span class="keyword">in</span> config.options(section):</div><div class="line">		option_result[option] = config.get(section,option)</div><div class="line">	<span class="keyword">return</span> option_result</div></pre></td></tr></table></figure>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#! -*- coding:utf-8 -*-</span></div><div class="line"><span class="keyword">import</span> ConfigParser</div><div class="line"><span class="keyword">import</span> io</div><div class="line"></div><div class="line"><span class="comment"># opt_move函数，实现在sections之间移动option的功能</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">opt_move</span><span class="params">(config, section1, section2, option)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        config.set(section2, option, config.get(section1, option, <span class="number">1</span>))</div><div class="line">    <span class="keyword">except</span> ConfigParser.NoSectionError:</div><div class="line">        config.add_section(section2)</div><div class="line">        opt_move(config, section1, section2, option)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        config.remove_option(section1, option)</div></pre></td></tr></table></figure>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># mysql.config</span></div><div class="line">[Frist_mysql]</div><div class="line">outer_host = <span class="number">192.168</span><span class="number">.0</span><span class="number">.1</span></div><div class="line">inner_host = <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></div><div class="line">user = reader</div><div class="line">passwd = passwd</div><div class="line">db = text</div><div class="line">charset = gbk</div><div class="line">port = <span class="number">3306</span></div><div class="line"></div><div class="line">[Second_mysql]</div><div class="line">outer_host = <span class="number">192.168</span><span class="number">.0</span><span class="number">.2</span></div><div class="line">inner_host = <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></div><div class="line">user = reader</div><div class="line">passwd = passwd</div><div class="line">db = text</div><div class="line">charset = gbk</div><div class="line">port = <span class="number">3306</span></div></pre></td></tr></table></figure>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#! -*- coding:utf-8 -*-</span></div><div class="line"><span class="keyword">import</span> MySQLdb</div><div class="line"><span class="keyword">import</span> ConfigParser</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MysqlUtil</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, filepath, section)</span>:</span></div><div class="line">        self.filepath = filepath</div><div class="line">        self.section = section</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getMysqlConfig</span><span class="params">(self)</span>:</span></div><div class="line">        result = []</div><div class="line">        conf = ConfigParser.ConfigParser()</div><div class="line">        conf.read(self.filepath)</div><div class="line">        options = conf.options(self.section)</div><div class="line">        <span class="keyword">if</span> sys.platform.find(<span class="string">"win"</span>) &gt;= <span class="number">0</span>:</div><div class="line">            options.pop(options.index(<span class="string">"inner_host"</span>))</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            options.pop(options.index(<span class="string">"outer_host"</span>))</div><div class="line">        <span class="keyword">for</span> option <span class="keyword">in</span> options:</div><div class="line">            result.append(conf.get(self.section, option))</div><div class="line">        <span class="keyword">return</span> result</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">connect</span><span class="params">(self)</span>:</span></div><div class="line">        host, user, passwd, db, charset, port = self.getMysqlConfig()</div><div class="line">        port = int(port)</div><div class="line">        self.conn = MySQLdb.connect(host=host, user=user,</div><div class="line">                               passwd=passwd, db=db, charset=charset, port=port)</div><div class="line">        self.cur = self.conn.cursor()</div><div class="line">        <span class="keyword">return</span> self.conn, self.cur</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">select</span><span class="params">(self, str_sql)</span>:</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> str_sql:</div><div class="line">            <span class="keyword">return</span></div><div class="line">        conn, cur = self.connect()</div><div class="line">        cur.execute(str_sql)</div><div class="line">        out = cur.fetchall()</div><div class="line">        <span class="keyword">return</span> out</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(self, str_sql)</span>:</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> str_sql:</div><div class="line">            <span class="keyword">return</span></div><div class="line">        conn, cur = self.connect()</div><div class="line">        cur.execute(str_sql)</div><div class="line">        conn.commit()</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.conn:</div><div class="line">            <span class="keyword">return</span></div><div class="line">        self.conn.close()</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    mysqlutil_instance = MysqlUtil(<span class="string">'./mysql.config'</span>,<span class="string">'section_name'</span>)</div><div class="line">    select_sql = <span class="string">'''select * from table_name limit 5'''</span></div><div class="line">    mysql_connect.select(sql)</div></pre></td></tr></table></figure>
<hr>
<h3 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h3><p><a href="https://docs.python.org/2.7/library/configparser.html#configparser-objects" target="_blank" rel="external">https://docs.python.org/2.7/library/configparser.html#configparser-objects</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://fujiador.github.io/2017/04/06/数据结构：树、二叉树、二叉树搜索-一/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Fujia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fujia's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/06/数据结构：树、二叉树、二叉树搜索-一/" itemprop="url">
                  数据结构：树、二叉树、二叉树搜索(一)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-06T22:31:46+08:00">
                2017-04-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据结构/" itemprop="url" rel="index">
                    <span itemprop="name">数据结构</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="树"><a href="#树" class="headerlink" title="树"></a>树</h2><hr>
<h3 id="树的特征和定义"><a href="#树的特征和定义" class="headerlink" title="树的特征和定义"></a>树的特征和定义</h3><p>树(Tree)是元素的集合。先以较直观的方式介绍树，如下图的数据结构是一个树：<br><img src="http://on58f12qv.bkt.clouddn.com/%E6%A0%91-%E7%BB%93%E6%9E%84.png" alt="数据结构-树|center|260x0"></p>
<p>树有多个<strong>节点(Node)</strong>，用来存储元素。某些节点之间存在一定的关系，用连线表示，连线称为<strong>边(edge)</strong>。边的上端节点称为<strong>父节点</strong>，下端节点称为<strong>子节点</strong>。树像一个不断分叉的树根。</p>
<p>每个节点可以有多个<strong>子节点(children)</strong>，而该节点是相应子节点的<strong>父节点(parent)</strong>。比如，3、5是6的子节点，6是3、5的父节点；1、8、7是3的子节点，3是1、8、7的父节点。树有一个没有父节点的节点，称为<strong>根结点(root)</strong>，如图中的6。没有子节点的节点称为<strong>叶结点(leaf)</strong>，比如图中的1、8、9、5节点。从图中还可以看到，上面的树总共有4个层次，6位于第一层，9位于第四层。树中节点的最大层次被称为<strong>深度</strong>，也就是说，该树的<strong>深度(depth)</strong>为4。</p>
<p>如果从节点3开始向下看，那么我们看到的是一个以节点3位根节点的树，其中三角形代表一颗树：<br><img src="http://on58f12qv.bkt.clouddn.com/%E6%A0%91-%E5%AD%90%E6%A0%91.png" alt="子树|center|300x0"></p>
<p>再进一步，如果我们定义孤立的一个节点也是一颗树的话，原来的树就可以表示为根节点和子树(subtree)的关系：<br><img src="http://on58f12qv.bkt.clouddn.com/%E6%A0%B9%E8%8A%82%E7%82%B9+%E5%AD%90%E6%A0%91.png" alt="根节点+子树|center|160x0"></p>
<p>上述观察实际上给了我们一种严格的定义树的方法：</p>
<ol>
<li>树是元素的集合</li>
<li>该集合可以为空。这时树种没有元素，称树为空树(empty tree)</li>
<li>如果该集合不为空，那么该集合有一个根节点，以及0个或多个子树。根节点与它的子树的根节点用一个边相连</li>
</ol>
<p>上面的第三点，是以递归的方式来定义树，也就是在定义树的过程中使用了树自身(子树)。由于树的递归特征，许多相关的操作也可以方便的使用递归实现。</p>
<hr>
<h3 id="树的实现"><a href="#树的实现" class="headerlink" title="树的实现"></a>树的实现</h3><p>树的示意图已经给出了树的一种内存实现方式：每个节点存储元素和多个指向子节点的指针。然而，子节点数目是不确定的。一个父节点可能有大量的子节点，而另一个父节点可能只有一个子节点，而树的增删节点操作会让子节点的数目发生进一步的变化。这种不确定性就可能带来大量的内存相关操作，并且容易造成内存的浪费。</p>
<p>一种经典的实现方式如下：<br><img src="http://on58f12qv.bkt.clouddn.com/%E6%A0%91%E7%9A%84%E5%86%85%E5%AD%98%E5%AE%9E%E7%8E%B0.png" alt="树的内存实现|center|260x0"></p>
<p>拥有同一父节点的两个节点互为<strong>兄弟节点(siblling)</strong>。上图的实现方式中，每个节点包含有一个指针指向第一个子节点，并有另一个指针指向它的下一个兄弟节点。这样，我们就可以用同一的、确定的结构来表示每个节点。</p>
<p>计算机的文件系统是树的结构，比如Linux文件系统。在UNIX的文件系统中，每个文件（文件夹同样是一种文件）都可以看做是一个节点。非文件夹的文件被存储在叶结点。文件夹中有指向父节点和子节点的指针（在UNIX中，文件夹还包含一个指向自身的指针）。</p>
<hr>
<h2 id="二叉树"><a href="#二叉树" class="headerlink" title="二叉树"></a>二叉树</h2><p><strong>二叉树(binary)</strong>是一种特殊的树。二叉树的每个节点最多只能有2个子节点。<br><img src="http://on58f12qv.bkt.clouddn.com/%E4%BA%8C%E5%8F%89%E6%A0%91.png" alt="二叉树|center|260x0"></p>
<p>由于二叉树的子节点数目确定，所以可以直接采用上图方式在内存中实现。每个节点有一个左子节点(left children)和右子节点(right children)。左子节点是左子树的根节点，右子节点是右子树的根节点。</p>
<hr>
<h2 id="二叉搜索树"><a href="#二叉搜索树" class="headerlink" title="二叉搜索树"></a>二叉搜索树</h2><p>如果给二叉树加一个额外的条件，就可以得到一种称为二叉搜索树(binary search tree)的特殊二叉树。二叉搜索树要求：每个节点都不比它左子树的任意元素小，而且不比它的右子树的任意元素大。<br><img src="http://on58f12qv.bkt.clouddn.com/%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91.png" alt="二叉搜索树|center|260x0"></p>
<p>二叉搜索树可以方便的实现搜索算法。在搜索元素x的时候，我们可以将x和根节点比较：</p>
<ol>
<li>如果x等于根节点，那么找到x，停止搜索（终止条件）</li>
<li>如果x小于根节点，那么搜索左子树</li>
<li>如果x大于根节点，那么搜索右子树<br>二叉搜索树所需要进行的操作次数最多与树的深度相等。n个节点的二叉搜索树的深度最多为n，最少为log(n)。</li>
</ol>
<p>删除节点相对比较复杂。删除节点后，有时需要进行一定的调整，以恢复二叉搜索树的性质（每个节点都不比它左子树的任意元素小，而且不比它的右子树的任意元素大）。</p>
<ul>
<li>叶节点可以直接删除</li>
<li>删除非叶结点时，比如下图中的节点8.可以删除左子树中最大的元素，用其他的节点来补充元素8产生的空缺。但该元素可能也不是叶结点，所以它所产生的空缺需要其他元素补充。如下过程：<br><img src="http://on58f12qv.bkt.clouddn.com/%E5%88%A0%E9%99%A4%E8%8A%82%E7%82%B9.png" alt="删除节点|center|260x0"><br><img src="http://on58f12qv.bkt.clouddn.com/%E5%88%A0%E9%99%A4%E8%8A%82%E7%82%B9%E5%90%8E%E7%9A%84%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91.png" alt="删除节点后的二叉搜索树|center|280x0"></li>
</ul>
<h2 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h2><p><strong>[转载]</strong> <a href="http://www.cnblogs.com/vamei/archive/2013/03/17/2962290.html" target="_blank" rel="external">http://www.cnblogs.com/vamei/archive/2013/03/17/2962290.html</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Fujia" />
          <p class="site-author-name" itemprop="name">Fujia</p>
           
              <p class="site-description motion-element" itemprop="description">好记性不如烂笔头,更何况记性还不好</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">25</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">22</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Fujia</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->



  



  




	





  





  





  






  





  

  

  

  

</body>
</html>
